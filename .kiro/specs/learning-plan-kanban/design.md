# Design Document

---
**Purpose**: è¦ä»¶ã‚’æº€ãŸã™ãŸã‚ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã€å®Ÿè£…ãƒ–ãƒ¬ã‚’é˜²ãã€‚
---

## ç”¨èªé›†
| æ­£å¼åç§° | ç•¥ç§° | ç¨®åˆ¥ | èª¬æ˜ |
| --- | --- | --- | --- |
| ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰ | KanbanBoard | UIï¼ˆView/Boardï¼‰ | æ•™ç§‘Ã—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å›ºå®šã‚°ãƒªãƒƒãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ãƒœãƒ¼ãƒ‰ Viewã€‚ |
| ãƒ—ãƒ©ãƒ³ãƒ“ãƒ¥ãƒ¼ | PlanView | UIï¼ˆViewï¼‰ | æœˆæ›œå§‹ã¾ã‚Šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨äºˆå®š/å­¦ç¿’æ™‚é–“è¡¨ç¤ºã® Viewã€‚ |
| é–²è¦§å°‚ç”¨ãƒ“ãƒ¥ãƒ¼ | ReadOnlyView | UIï¼ˆViewï¼‰ | é–²è¦§å°‚ç”¨ãƒ¢ãƒ¼ãƒ‰ã® Viewã€‚ |
| ã‚¢ãƒ©ãƒ¼ãƒˆãƒãƒ¼ | AlertToast | UIï¼ˆToastï¼‰ | åŒæœŸ/PT/éè² è·ãªã©ã®éãƒ¢ãƒ¼ãƒ€ãƒ«é€šçŸ¥ã‚’ç”»é¢å³ä¸‹ã®ãƒˆãƒ¼ã‚¹ãƒˆã§è¡¨ç¤ºã™ã‚‹ UI è¦ç´ ã€‚ |
| ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | Navigation | UI | View åˆ‡æ›¿ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼/ã‚¿ãƒ–ã€‚ |
| ãƒãƒ£ãƒ¼ãƒˆ | Chart | UI | ã‚°ãƒ©ãƒ•å¯è¦–åŒ–è¦ç´ ï¼ˆãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ãªã©ï¼‰ã€‚ |
| View | - | UI | ç”»é¢å˜ä½ã® UIã€‚ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§åˆ‡æ›¿ã€‚ |
| Panel | - | UI | View å†…ã®è¨­å®š/è£œåŠ©ã‚¨ãƒªã‚¢ã€‚ |
| Mode | - | æ¦‚å¿µ | æ©Ÿèƒ½/è¡¨ç¤ºã®åˆ‡æ›¿çŠ¶æ…‹ï¼ˆviewMode: editable/readonlyã€TaskDialog å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰: å€‹åˆ¥/ä¸€æ‹¬ ãªã©ï¼‰ã€‚ |

## Overview
å­¦ç¿’è¨ˆç”»ã‚«ãƒ³ãƒãƒ³ï¼ˆLPKï¼‰ã¯ãƒ–ãƒ©ã‚¦ã‚¶å®Œçµã® PWA ã¨ã—ã¦ã€æ•™ç§‘Ã—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å›ºå®šã‚°ãƒªãƒƒãƒ‰ä¸Šã§ã‚¿ã‚¹ã‚¯ã‚’é‹ç”¨ã—ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚ç·¨é›†ãƒ»è¨ˆæ¸¬ã‚’ç¶™ç¶šã—ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¾©å¸°æ™‚ã«åŒæœŸã™ã‚‹ã€‚Google Drive ã‚’ä¸»ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€Google Calendar ã‚’äºˆå®šé€£æºã«ç”¨ã„ã€é€±æ¬¡ã‚¹ãƒ—ãƒªãƒ³ãƒˆã®è¨ˆç”»ã¨æ—¥æ¬¡é‹ç”¨ã€é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¸€è²«ã—ã¦æ”¯æ´ã™ã‚‹ã€‚

### Goals
- å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ã¨æ•™ç§‘è¡Œã«ã‚ˆã‚‹2æ¬¡å…ƒã‚«ãƒ³ãƒãƒ³ã§ã€ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã¨ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç·¨é›†ã‚’å®‰å…¨ã«æä¾›ã™ã‚‹ã€‚
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆã‚¢ã¨åŒæœŸã‚¨ãƒ³ã‚¸ãƒ³ã§ã€Google Drive/Calendar ã¸ã®åŒæ–¹å‘åŒæœŸã‚’å®Ÿç¾ã™ã‚‹ã€‚
- æ™‚é–“ç®¡ç†ï¼ˆäºˆå®š/æ®‹ã‚Šæ™‚é–“ã€PTã€è‡ªå‹•è¨ˆæ¸¬ï¼‰ã¨ Today éè² è·è­¦å‘Šã‚’ä¸€è²«ã—ãŸãƒ­ã‚¸ãƒƒã‚¯ã§æä¾›ã™ã‚‹ã€‚

### Non-Goals
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒã®æ–°è¦æ§‹ç¯‰ï¼ˆGitHub Pages é…ä¿¡ã®ã¿ï¼‰ã€‚
- RSC/SSR ãƒ™ãƒ¼ã‚¹ã® UI ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ï¼ˆå¿…è¦ãªã‚‰åˆ¥é€”æ¤œè¨ï¼‰ã€‚
- AI è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãªã©è¦ä»¶å¤–ã®é«˜åº¦æ©Ÿèƒ½ã€‚

## Architecture

### Existing Architecture Analysis
æ–°è¦å®Ÿè£…ï¼ˆæ—¢å­˜ã‚³ãƒ¼ãƒ‰ãªã—ï¼‰ã€‚ã‚¹ãƒ†ã‚¢ãƒªãƒ³ã‚°ã®ã‚¹ã‚¿ãƒƒã‚¯æ–¹é‡ï¼ˆReact + Vite + TanStack Router + Zustandã€PWAã€Google APIï¼‰ã‚’å‰æã«è¨­è¨ˆã™ã‚‹ã€‚

### Architecture Pattern & Boundary Map
æ¡ç”¨: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ Cleanï¼ˆPorts/Adaptersï¼‰ï¼‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆã‚¢ï¼åŒæœŸã‚¨ãƒ³ã‚¸ãƒ³åˆ†é›¢ã€‚

```mermaid
graph TB
  subgraph UI
    AppShell[AppShell]
    KanbanBoard[KanbanBoard]
    TaskDialog[TaskDialog]
    Dashboard[Dashboard]
    PlanView[PlanView]
    ReadOnlyView[ReadOnlyView]
    HelpPage[HelpPage]
  end
  subgraph State
    TaskStore[TaskStore Zustand]
    StatusPolicy[StatusPolicy]
    TimeCalc[TimeCalc]
    Burndown[Burndown]
    Availability[Availability]
    Pomodoro[PomodoroTimer]
  end
  subgraph Sync
    SyncEngine[SyncEngine]
    DriveAdapter[DriveAdapter]
    CalendarAdapter[CalendarAdapter]
    StorageAdapter[StorageAdapter IndexedDB]
  end
  subgraph Infra
    ServiceWorker[ServiceWorker]
    UpdateManager[UpdateManager]
    Auth[Auth Google]
  end
  KanbanBoard --> TaskStore
  TaskDialog --> TaskStore
  Dashboard --> TaskStore
	  PlanView --> TaskStore
	  TaskStore --> StatusPolicy
	  TaskStore --> TimeCalc
	  TaskStore --> Burndown
	  TaskStore --> Availability
	  TaskStore --> SyncEngine
  SyncEngine --> StorageAdapter
  SyncEngine --> DriveAdapter
  SyncEngine --> CalendarAdapter
  ServiceWorker --> UpdateManager
```

### Thread / Worker Strategy
- Threads in scope: ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ï¼ˆUI/çŠ¶æ…‹/åŒæœŸå‡¦ç†ï¼‰ï¼‹ Service Workerï¼ˆPWA ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°åˆ¶å¾¡ï¼‰ï¼‹ Web Workerï¼ˆDrive ã®ãƒãƒ¼ã‚¸/å·®åˆ†è¨ˆç®—ãªã©ã® CPU è² è·ãŒé«˜ã„å‡¦ç†ï¼‰ã€‚
- Service Worker ã§æ‰±ã†ã‚‚ã®: precache/route ã«ã‚ˆã‚‹ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œçŸ¥ã¨ `updatefound/statechange` ç›£è¦–ã€`skipWaiting` ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒªãƒ­ãƒ¼ãƒ‰è¦æ±‚ã€ç°¡æ˜“ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã€‚Push/Periodic Background Sync ã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹æ–¹é‡ï¼‹Safari åˆ¶ç´„ã®ãŸã‚ä¸æ¡ç”¨ã€‚
- ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§æ‰±ã†ã‚‚ã®: UI/çŠ¶æ…‹ç®¡ç†ï¼ˆReact+Zustandï¼‰ã€SyncEngine ã® `sync()`ï¼ˆpullâ†’mergeâ†’pushï¼‰ã€Drive/Calendar API å‘¼ã³å‡ºã—ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³å¤±åŠ¹ UI ã¨é€£æºã—ã‚„ã™ãã™ã‚‹ï¼‰ã€InProAutoTracker/Pomodoro ã®è¨ˆæ¸¬ã¨é€šçŸ¥ã€Availability/Calendar/Settings ç·¨é›†ï¼ˆviewMode=readonly ã§ã¯ç·¨é›†ç„¡åŠ¹åŒ–ï¼‰ã€BackupService ã®é–‹å§‹/å®Œäº†é€šçŸ¥ã¨ UI é€²æ—ã€‚
- Web Worker ã§æ‰±ã†ã‚‚ã®: Drive ã® remoteâ†’local ãƒãƒ¼ã‚¸ï¼ˆå·®åˆ†è¨ˆç®—ã€PrioritySorter å†è¨ˆç®—ã€å¿…è¦ãªã‚‰ Burndown å†è¨ˆç®—ï¼‰ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã® zip åœ§ç¸®/å±•é–‹ï¼ˆå¤§ãã„å ´åˆï¼‰ã€‚UI ã¯æ“ä½œä¸èƒ½ãªãŸã‚ã€Worker ã¯ã€ŒçŠ¶æ…‹ã‚’ç›´æ¥å¤‰æ›´ã€ã›ãšã€Œé©ç”¨å¯èƒ½ãª patchï¼ˆå·®åˆ†ï¼‰ã€ã‚’è¿”ã™ã€‚
- æ¡ç”¨åŸºæº–: Service Worker ã§ã—ã‹ã§ããªã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥/ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°/ãƒãƒƒãƒˆãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã®ã¿ SW ã¸ç½®ãã€ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡ŒãŒå‰æã®åŒæœŸãƒ»è¨ˆæ¸¬ãƒ»ç·¨é›†ãƒ­ã‚¸ãƒƒã‚¯ã¯ãƒ¡ã‚¤ãƒ³ã«é™å®šã™ã‚‹ã€‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ã‚µãƒ¼ãƒçµŒç”±é€šçŸ¥ãŒå¿…è¦ã«ãªã‚‹å ´åˆã¯è¦ä»¶ã¨ã‚µãƒ¼ãƒãƒ¬ã‚¹æ–¹é‡ã‚’å†æ¤œè¨ã™ã‚‹ã€‚

### Technology Stack

| Layer | Choice / Version | Role in Feature | Notes |
|-------|------------------|-----------------|-------|
| Frontend | React 18 + Vite | SPA/PWA UI å®Ÿè¡ŒåŸºç›¤ | Vite ã§é«˜é€Ÿ dev/buildã€PWA ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æƒ³å®š |
| State | Zustand | ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | ãƒŸãƒ‰ãƒ«çŠ¶æ…‹ã‚’ hooks ã§æä¾› |
| Routing | TanStack Router | ç”»é¢é·ç§»ï¼ˆã‚«ãƒ³ãƒãƒ³/ãƒ—ãƒ©ãƒ³/ãƒ˜ãƒ«ãƒ—/é–²è¦§å°‚ç”¨ï¼‰ | å‹å®‰å…¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |
| UI | MUI + dnd-kit | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ DnD | ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œå‰æ |
| i18n | i18next + react-i18next | UI æ–‡å­—åˆ—ç®¡ç†ï¼ˆå°†æ¥ã®å¤šè¨€èªå¯¾å¿œï¼‰ | `lang` ã¯ `ja-JP` å›ºå®šã€è¨€èªåˆ‡æ›¿ UI ã¯æä¾›ã—ãªã„ |
| Data Store | IndexedDB | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ°¸ç¶šï¼ˆçŠ¶æ…‹ï¼‹åŒæœŸçŠ¶æ…‹ï¼‰ | StorageAdapter ã§æŠ½è±¡åŒ– |
| Sync | Google Drive API / Google Calendar API | ä¸»ãƒ‡ãƒ¼ã‚¿ï¼äºˆå®šã®åŒæ–¹å‘åŒæœŸ | Drive ã¯ JSON ãƒ•ã‚¡ã‚¤ãƒ«ã€Calendar ã¯ syncToken å·®åˆ† |
| PWA | Service Worker + @vite-pwa/plugin | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ | éãƒ¢ãƒ¼ãƒ€ãƒ«é€šçŸ¥ã§æ›´æ–° |
| Testing | Vitest + RTL + MSW + Playwright | å˜ä½“/çµ±åˆ/E2E | Steering/testing ã«æº–æ‹  |

## System Flows

### ã‚¿ã‚¹ã‚¯ç§»å‹•ï¼ˆDnDï¼‰ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ã‚¬ãƒ¼ãƒ‰
```mermaid
sequenceDiagram
  participant U as User
  participant KB as KanbanBoard
  participant SP as StatusPolicy
  participant TS as TaskStore
  participant SE as SyncEngine
  participant IDB as StorageAdapter
  U->>KB: Drag TCard to target cell
  KB->>TS: moveTask(taskId, to, initiator)
  TS->>SP: validateMove({taskId, from, to, context, initiator})
  SP-->>TS: decision {allowed, sideEffects, reason?}
  alt allowed
    TS->>TS: apply state + sideEffects (atomic)
    TS->>IDB: persist(stateSnapshot)  %% StorageAdapter çµŒç”±
    TS->>SE: markDirty()
    TS-->>KB: ok
  else rejected
    TS-->>KB: PolicyError(reason)
    KB-->>U: show block reason
  end
```
Key: ãƒ­ãƒ¼ã‚«ãƒ«æ“ä½œã§ã¯ãƒãƒªã‚·ãƒ¼ãŒ Today å…ˆé ­ã®ã¿â†’InProã€OnHold å…ˆé ­ã®ã¿â†’InProã€Done é·ç§»æ¡ä»¶ã€InPro å”¯ä¸€æ€§ã€è‡ªå‹• OnHold é€€é¿ã‚’è¿”ã™ã€‚ç«¯æœ«é–“åŒæœŸã®ãƒãƒ¼ã‚¸å¾Œã«ä¸æ•´åˆï¼ˆInPro è¤‡æ•°ï¼‰ãŒæ··å…¥ã—ãŸå ´åˆã¯ SyncEngine å´ã§æ­£è¦åŒ–ã™ã‚‹ï¼ˆSyncEngine ã® Implementation Notesã€ŒInvariant æ­£è¦åŒ–ï¼ˆãƒãƒ¼ã‚¸å¾Œï¼‰ã€ã‚’å‚ç…§ï¼‰ã€‚

### ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åŒæœŸã‚µã‚¤ã‚¯ãƒ«ï¼ˆDrive/Calendarï¼‰
```mermaid
sequenceDiagram
  participant TS as TaskStore
  participant SE as SyncEngine
  participant DA as DriveAdapter
  participant CA as CalendarAdapter
  participant IDB as StorageAdapter
  loop periodic/online
    TS->>SE: sync()
    SE->>DA: pullHeads/pullSnapshots
    SE->>CA: pullCalendarDiff (online only)
    DA-->>SE: remoteSnapshots
    CA-->>SE: calendarDiff
    SE->>TS: applyRemote(remoteSnapshots, calendarDiff)
    SE->>DA: pushSnapshots (if dirty)
    SE->>IDB: persist(stateSnapshot, syncState)
  end
```
Key: syncToken å¤±åŠ¹æ™‚ã¯ãƒ•ãƒ«å†å–å¾—ã€ç«¶åˆæ™‚ã¯ä¿å®ˆçš„ãƒãƒ¼ã‚¸ï¼‹ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ã€‚

### UI éšå±¤æ§‹é€ ï¼ˆã‚³ãƒ³ãƒ†ãƒŠã¨ä¸»è¦ç”»é¢ï¼‰
```mermaid
flowchart TD
  AppShell[AppShell Router]
  Nav[Navigation Tabs/Menu]
  Main[Main View]
  Kanban[KanbanBoard]
  TaskDialog[TaskDialog Modal]
  Plan[PlanView]
  Dashboard[Dashboard]
  Burndown[Burndown Chart]
  Settings[SettingsPanel]
  AlertToast[AlertToast Global]

  AppShell --> Nav
  AppShell --> Main
  AppShell --> AlertToast
  Main --> Kanban
  Main --> Plan
  Main --> Dashboard
  Main --> Settings
  Kanban --> TaskDialog
  Dashboard --> Burndown
```

### UI ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆASCII ã‚¹ã‚±ãƒƒãƒï¼‰

#### KanbanView

- `Menu Button` ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ SettingsPanel ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- `YYYY/MM/DD - MM/DD` ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆæœŸé–“è¡¨ç¤ºã¯é€±é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ãã€å‰é€±/ç¿Œé€±ãƒœã‚¿ãƒ³ã§ã‚‚åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚
- ã‚¹ãƒ—ãƒªãƒ³ãƒˆæœŸé–“è¡¨ç¤ºã¯é€±é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§é¸æŠã—ãŸé€±ã«é€£å‹•ã—ã¦æ›´æ–°ã™ã‚‹ã€‚
- `ãƒ—ãƒ©ãƒ³` ãƒœã‚¿ãƒ³ã§ PlanView ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- `ã‚«ãƒ³ãƒãƒ³` ã¨ `ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰` ã¯ãƒˆã‚°ãƒ«ã§ã€è¡¨ç¤ºã—ã¦ã„ã‚‹æ–¹ã‚’ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆã™ã‚‹
- `sync status` ã¯ Google Drive ã¨ã®åŒæœŸçŠ¶æ…‹ã‚’ã‚¢ã‚¤ã‚³ãƒ³ã§ç¤ºã™
- `avator` ã¯ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ãƒã‚¿ãƒ¼ã‚’è¡¨ç¤º
- `Num of Today/Due tasks` ã¯æœ¬æ—¥å®Ÿæ–½äºˆå®šã®ã‚¿ã‚¹ã‚¯æ•°ã¨å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã‚’è¦–è¦šçš„ã«è¡¨ç¤ºã™ã‚‹ï¼ˆéå»ãƒ»æœªæ¥ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ä½•ã‚‚è¡¨ç¤ºã—ãªã„ï¼‰
- `Estimate/Done Time ` ã¯æœ¬æ—¥ã®å‹‰å¼·å¯èƒ½æ™‚é–“ã¨å®Ÿç¸¾æ™‚é–“ã‚’è¦–è¦šçš„ã«è¡¨ç¤ºã™ã‚‹ï¼ˆéå»ãƒ»æœªæ¥ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ä½•ã‚‚è¡¨ç¤ºã—ãªã„ï¼‰
- ğŸ… ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ãŒå§‹ã¾ã‚‹

```ditaa
+-----------------------------------------------------------------------------------------------+
| AppBar: [Menu Button] [Logo] [â—€][YYYY/MM/DD - MM/DD][â–¶] [ãƒ—ãƒ©ãƒ³][ã‚«ãƒ³ãƒãƒ³|ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] [sync][avatar] |
+-----------------------------------------------------------------------------------------------+
| Kanban Header: Num of Today/Done Tasks | Estimate/Done Time                           [ğŸ…] |
+---------+-------------+-------------+---------------+-------------+------------+------------+
|         | Backlog     |    Today    |  InPro        |  OnHold     |   Done     | Won't fix  |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|+-----------+|+-------------+|+-----------+|+----------+|+----------+|
| English ||TCard      |||           ||| TCard for   |||           |||          |||          ||
|         |+-----------+|+-----------+|| InPro       ||+-----------+|+----------+|+----------+|
|         |+-----------+|+-----------+||             ||             |+----------+|            |
|         ||           |||           |||             ||             ||          ||            |
|         |+-----------+|+-----------+||             ||             |+----------+|            |
|         |             |+-----------+||             ||             |            |            |
|         |     +       ||           |||             ||             |            |            |
|         |             |+-----------+|+-------------+|             |            |            |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|+-----------+|               |             |            |            |
| Math    ||           |||           ||               |             |            |            |
|         |+-----------+|+-----------+|               |             |            |            |
|         |     +       |             |               |             |            |            |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|             |               |             |            |            |
| Science ||           ||             |               |             |            |            |
+---------++-----------++-------------+---------------+-------------+------------+------------+
```

#### KanvanView with Pomodoro Timer

- Kanban Header ã¯ ğŸ… ãƒœã‚¿ãƒ³ã®ã¿ã‚’è¡¨ç¤ºã—ã€é–‹å§‹/å†é–‹ã§ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¯ã‚«ãƒ³ãƒãƒ³å³ä¸Šã®ã‚„ã‚„å†…å´ã«å°ã•ã‚ã‚µã‚¤ã‚ºã§è¡¨ç¤ºã™ã‚‹ã€‚
- é›†ä¸­/ä¼‘æ†©ãƒ•ã‚§ãƒ¼ã‚ºã¯èƒŒæ™¯è‰²ã§åŒºåˆ¥ã—ã€æ®‹ã‚Šæ™‚é–“ã¯ä¸­å¤®ã«é…ç½®ã™ã‚‹ã€‚
- é€²æ—ã‚²ãƒ¼ã‚¸ã¯æ™‚é–“ã®èƒŒé¢ã«è¡¨ç¤ºã—ã€10 ç§’åˆ»ã¿ã§æ›´æ–°ã™ã‚‹ã€‚
- åœæ­¢ã¯ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’é–‰ã˜ã¦ã‚¿ã‚¤ãƒãƒ¼ã‚’åœæ­¢ã—ã€ãƒªã‚»ãƒƒãƒˆã¯ã‚¿ã‚¤ãƒãƒ¼ã¨è¡¨ç¤ºã‚’åˆæœŸåŒ–ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’é–‰ã˜ã‚‹ã€‚

```ditaa
+---------------------------------------------------------------------------------------------+
| AppBar: [Menu Button] [Logo] [â—€][YYYY/MM/DD - MM/DD][â–¶] [ãƒ—ãƒ©ãƒ³][ã‚«ãƒ³ãƒãƒ³|ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] [sync][avatar] |
+---------------------------------------------------------------------------------------------+
| Kanban Header: Num of Today/Done Tasks | Estimate/Done Time                           [ğŸ…] |
|                                                                     +---------------------+ |
+---------+-------------+-------------+---------------+-------------+ | Pomodoro Time       | |
|         | Backlog     |    Today    |  InPro        |  OnHold     | |                     | |
|---------+-------------+-------------+---------------+-------------+ |                     | |
|         |+-----------+|+-----------+|+-------------+|+-----------+| |                     | |
| English ||TCard      |||           |||             |||           || |       Time          | |
|         |+-----------+|+-----------+||             ||+-----------+| |                     | |
|         |+-----------+|+-----------+||             ||             | |                     | |
|         ||           |||           |||             ||             | |                     | |
|         |+-----------+|+-----------+||             ||             | |   Stop    Reset     | |
|         |             |+-----------+||             ||             | +---------------------+ |
|         |     +       ||           |||             ||             |            |            |
|         |             |+-----------+|+-------------+|             |            |            |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|+-----------+|               |             |            |            |
| Math    ||           |||           ||               |             |            |            |
|         |+-----------+|+-----------+|               |             |            |            |
|         |     +       |             |               |             |            |            |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|             |               |             |            |            |
| Science ||           ||             |               |             |            |            |
+---------++-----------++-------------+---------------+-------------+------------+------------+
```

#### KanbanView with Alert

- åŒæœŸ/éè² è·/PT ãªã©ã®é€šçŸ¥ã¯ã€ç”»é¢å³ä¸‹ã® `AlertToast` ã§éãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºã™ã‚‹ã€‚

```ditaa
+---------------------------------------------------------------------------------------------+
| AppBar: [Menu Button] [Logo] [â—€][YYYY/MM/DD - MM/DD][â–¶] [ãƒ—ãƒ©ãƒ³][ã‚«ãƒ³ãƒãƒ³|ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] [sync][avatar] |
+---------------------------------------------------------------------------------------------+
| Kanban Header: Num of Today/Done tasks | Estimate/Done tasks                          [ğŸ…] |
+---------+-------------+-------------+---------------+-------------+------------+------------+
|         | Backlog     |    Today    |  InProgress   |  OnHold     |   Done     | Won't fix  |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|+-----------+|+-------------+|+-----------+|+----------+|+----------+|
| English ||TCard      |||           |||             |||           |||          |||          ||
|         |+-----------+|+-----------+||             ||+-----------+|+----------+|+----------+|
|         |+-----------+|+-----------+||             ||             |+----------+|            |
|         ||           |||           |||             ||             ||          ||            |
|         |+-----------+|+-----------+||             ||             |+----------+|            |
|         |             |+-----------+||             ||             |            |            |
|         |     +       ||           |||             ||             |            |            |
|         |             |+-----------+|+-------------+|             |            |            |
|---------+-------------+-------------+---------------+-------------+----- +-----+----------+ |
|         |+-----------+|+-----------+|               |             |      | Alert Toast 1  | |
| Math    ||           |||           ||               |             |      |                | |
|         |+-----------+|+-----------+|               |             |      +----------------+ |
|         |     +       |             |               |             |      +----------------+ |
|---------+-------------+-------------+---------------+-------------+----- | Alert Toast 2  | |
|         |+-----------+|             |               |             |      |                | |
| Science ||           ||             |               |             |      +----------------+ |
+---------++-----------++-------------+---------------+-------------+------------+------------+
```

#### KanbanView with Task Dialog

- `Task Dialog` ã¯ã‚«ãƒ³ãƒãƒ³ã®ä¸­å¤®ã«è¡¨ç¤ºã•ã‚Œã€D&Dã§ç§»å‹•å¯èƒ½ã€‚ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ‰±ã„ã§é–‰ã˜ã‚‹ã€‚

```ditaa
+---------------------------------------------------------------------------------------------+
| AppBar: [Menu Button] [Logo] [â—€][YYYY/MM/DD - MM/DD][â–¶] [ãƒ—ãƒ©ãƒ³][ã‚«ãƒ³ãƒãƒ³|ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] [sync][avatar] |
+---------------------------------------------------------------------------------------------+
| Kanban Header: Num of Today/Done Tasks | Estimate/Done Time                           [ğŸ…] |
+---------+-------------+-------------+---------------+-------------+------------+------------+
|         | Backlog     |    Today    |  InPro        |  OnHold     |   Done     | Won't fix  |
|---------+-------------+-------------+---------------+-------------+------------+------------|
|         |+-----------+|+-----------+|+-------------+|+-----------+|+----------+|+----------+|
| English ||TCard      |||         +----------------------+        |||          |||          ||
|         |+-----------+|+-------- | Task Dialog          | -------+|+----------+|+----------+|
|         |+-----------+|+-------- |                      |         |+----------+|            |
|         ||           |||         |                      |         ||          ||            |
|         |+-----------+|+-------- |                      |         |+----------+|            |
|         |             |+-------- |                      |         |            |            |
|         |     +       ||         |                      |         |            |            |
|         |             |+-------- |                      |         |            |            |
|---------+-------------+--------- |                      | --------+------------+------------|
|         |+-----------+|+-------- |                      |         |            |            |
| Math    ||           |||         |                      |         |            |            |
|         |+-----------+|+-------- |                      |         |            |            |
|         |     +       |          |                      |         |            |            |
|---------+-------------+--------- |                      | --------+------------+------------|
|         |+-----------+|          +----------------------+         |            |            |
| Science ||           ||             |               |             |            |            |
+---------++-----------++-------------+---------------+-------------+------------+------------+
```

#### TCard

- TCard ã¯ç¸¦ã«è¤‡æ•°ä¸¦ã¶ã®ã§æ¨ªé•·ã§è¡¨ç¤ºã™ã‚‹ã€‚
- InPro ä»¥å¤–ã® TCard ã¯ã€ã‚¿ã‚¤ãƒˆãƒ«ã¨æœŸæ—¥ï¼ˆæ›œæ—¥ï¼‰ã¨äºˆå®š/å®Ÿç¸¾æ™‚é–“ã®ã‚²ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- `Planned/Spent Time` ã¯ä½“åŠ›ã‚²ãƒ¼ã‚¸é¢¨ã®æ£’ã‚°ãƒ©ãƒ•ã§ `â– â– â– â–¡â–¡` ã®ã‚ˆã†ã«äºˆå®šæ™‚é–“ã¨å®Ÿç¸¾æ™‚é–“ã‚’å¯è¦–åŒ–ã™ã‚‹ï¼ˆæ®‹ã‚Šæ™‚é–“ã®æ•°å€¤ã¯è¡¨ç¤ºã—ãªã„ï¼‰ã€‚
- `Due Day of Week` ã¯ã‚¿ã‚¹ã‚¯ã®æœŸæ—¥ã‚’æ›œæ—¥ã§è¡¨ç¤ºã™ã‚‹ï¼ˆæœŸæ—¥ãŒãªã‘ã‚Œã°è¡¨ç¤ºã—ãªã„ï¼‰ã€‚
- `[icon]` ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã§ã€æœŸæ—¥ãŒæœ¬æ—¥ãªã‚‰èµ¤è‰²ã§è¡¨ç¤ºã™ã‚‹ï¼ˆæœŸæ—¥ãŒãªã‘ã‚Œã°è¡¨ç¤ºã—ãªã„ï¼‰ã€‚

```ditaa
+----------------------------------------+
|  Task Title     Planned/Spent Time     |
|                 [icon] Due Day of Week |
+----------------------------------------+
```

#### TCard (InPro)

- InPro ã® TCard ã¯æ­£æ–¹å½¢ã§è¡¨ç¤ºã—ã€1 ä»¶ã®ã¿å­˜åœ¨ã™ã‚‹ã€‚
- ã‚¿ã‚¤ãƒˆãƒ«ã¨äºˆå®š/å®Ÿç¸¾ã‚²ãƒ¼ã‚¸ã®é–“ã«ãƒ‰ãƒ¼ãƒŠãƒ„çŠ¶ã®å††å½¢ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’ã‚»ãƒ³ã‚¿ãƒªãƒ³ã‚°è¡¨ç¤ºã™ã‚‹ã€‚
- å††å½¢ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã¯ 60 åˆ†ã§ä¸€å‘¨ã—ã€è¡¨ç¤ºã™ã‚‹çµŒéåˆ†ã¯ãƒªã‚»ãƒƒãƒˆã›ãšã«ç¶™ç¶šåŠ ç®—ã™ã‚‹ã€‚
- é€²è¡Œä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™æ·¡è‰²ã®ç‚¹æ»…ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’ã€åˆ†æ•°è¡¨ç¤ºã®å·¦ä¸Šã«æ§ãˆã‚ã«è¡¨ç¤ºã™ã‚‹ã€‚
- äºˆå®š/å®Ÿç¸¾ã‚²ãƒ¼ã‚¸ã¯ InPro ç”¨ã®è¡¨ç¤ºã¨ã—ã¦åŒã˜ã‚«ãƒ¼ãƒ‰å†…ã«ä¿æŒã—ã€çµŒéæ™‚é–“ã«åˆã‚ã›ã¦æ•°å€¤ã¨ã‚²ãƒ¼ã‚¸ã‚’æ›´æ–°ã™ã‚‹ã€‚

```ditaa
+------------------------------+
|          Task Title          |
|------------------------------|
|         ( Circle )           |
|        Progress Ring         |
|            25 min            |
|------------------------------|
|    Planned/Spent Time        |
|    â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡    |
|   [icon] Due Day of Week     |
+------------------------------+
```

#### Task Dialog

- `Spent Time` ã® `[+]` ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨å®Ÿç¸¾ã‚’è¨˜éŒ²ã§ãã‚‹ã€‚
- `Spent Time` ã®ä¸­ã«ã¯ã€å®Ÿç¸¾ã‚’ãƒªã‚¹ãƒˆã§è¡¨ç¤ºã™ã‚‹ã€‚
- äºˆå®šæ™‚é–“/å®Ÿç¸¾æ™‚é–“ã®å…¥åŠ›ã¯æ•°å€¤ä»¥å¤–ã‚’é™¤å»ã—ã€ç©ºæ¬„ã®å ´åˆã¯ `0` ã‚’è£œå®Œã™ã‚‹ã€‚
- ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­æ›´æ–°ä¸­ã§ã‚‚ã€é–‹ã„ã¦ã„ã‚‹ TDialog ã®å…¥åŠ›ã¯å†åˆæœŸåŒ–ã—ãªã„ã€‚

```ditaa
+--------------------------+
| +----------------------+ |
| | Task title           | |
| |----------------------| |
| | Description          | |
| |                      | |
| |                      | |
| |                      | |
| |                      | |
| |                      | |
| |----------------------| |
| | Planned Time         | |
| |----------------------| |
| | Spent Time      [+]  | |
| | +------------------+ | |
| | |Day & Time        | | |
| | +------------------+ | |
| | |Day & Time        | | |
| | +------------------+ | |
| |----------------------| |
| | dueAt                | |
| +----------------------+ |
| +---+    +--------+----+ |
| |Del|    | Cancel | OK | |
| +---+    +--------+----+ |
+--------------------------+
```

#### PlanView

```ditaa
+-----------------------------------------------------------------------------------------------+
| AppBar: [Menu Button] [Logo] [â—€][YYYY/MM/DD - MM/DD][â–¶] [ãƒ—ãƒ©ãƒ³][ã‚«ãƒ³ãƒãƒ³|ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] [sync][avatar] |
+-----------------------------------------------------------------------------------------------+
| Plan                                                                                           |
| +-----------------------------------------------------------------------------------------+ |
| | DateCalendar (Mon start, week highlight, hover highlight)                                | |
| +-----------------------------------------------------------------------------------------+ |
| | Day View: Selected Date                                                                  | |
| | - Due Tasks                                                                              | |
| | - Overdue                                                                                | |
| | - Added Today                                                                            | |
| | - Actual                                                                                | |
| +-----------------------------------------------------------------------------------------+ |
| | Availability (0.5hã€œ15.0h Select)                                                        | |
| +-----------------------------------------------------------------------------------------+ |
| | Events: Title input + Add, list with empty state + offline error                          | |
| +-----------------------------------------------------------------------------------------+ |
+-----------------------------------------------------------------------------------------------+
```

- PlanView ã®ä¸Šéƒ¨ã¯åˆè¨ˆå¯èƒ½/è¨ˆç”»/å®Ÿç¸¾ã®ã‚µãƒãƒªã®ã¿ã‚’è¡¨ç¤ºã—ã€é€±é¸æŠã¯ AppBar å´ã§è¡Œã†ã€‚
- PlanView ã¯ç”»é¢å¹…ã«å¿œã˜ã¦ 1ã€œ3 åˆ—ã®ã‚°ãƒªãƒƒãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã€æ¨ªå¹…ã«ä½™è£•ãŒã‚ã‚‹å ´åˆã¯å·¦åˆ—ã«æœˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- main panel ã¨ side panel ã¯ç”»é¢é«˜ã«åˆã‚ã›ã¦ä¼¸é•·ã—ã€ç¸¦æ–¹å‘ã®ä½™ç™½ã‚’æœ€å°åŒ–ã™ã‚‹ã€‚
- æ—¥åˆ¥ã®å­¦ç¿’å¯èƒ½æ™‚é–“ã¯ 0.5ã€œ15.0 ã® 0.5h å˜ä½ã§é¸æŠã—ã€è¨ˆç”»/å®Ÿç¸¾ã®æ¯”è¼ƒã¯æ—¥åˆ¥æ£’ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã™ã‚‹ã€‚
- `seed=massive` ã‚’ URL ã‚¯ã‚¨ãƒªã«æŒ‡å®šã—ãŸå ´åˆã¯ã€å­¦ç¿’å¯èƒ½æ™‚é–“/ã‚¿ã‚¹ã‚¯/äºˆå®šã‚’å›ºå®šãƒ‡ãƒ¼ã‚¿ã§åˆæœŸåŒ–ã—ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã«ã‚¯ã‚¨ãƒªã‚’ä¿æŒã™ã‚‹ã€‚

#### DashboardView

```ditaa
+-----------------------------------------------------------------------------------------------+
| AppBar: [Menu Button] [Logo] [â—€][YYYY/MM/DD - MM/DD][â–¶] [ãƒ—ãƒ©ãƒ³][ã‚«ãƒ³ãƒãƒ³|ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] [sync][avatar] |
+-----------------------------------------------------------------------------------------------+
| Dashboard                                                                                    |
| +-----------------------------------------------------------------------------------------+ |
| | Status Summary by Subject (Backlog/Today/InPro/OnHold/Done/WontFix)                       | |
| +-----------------------------------------------------------------------------------------+ |
| | Weekly Summary (Done count, Actual minutes)                                              | |
| +-----------------------------------------------------------------------------------------+ |
| | Burndown (Daily remaining count/minutes)                                                 | |
| +-----------------------------------------------------------------------------------------+ |
+---------------------------------------------------------------------------------------------+
```

##### Weekly Resource Manager
- Dashboard ã¯ã€Œé€±æ¬¡ãƒªã‚½ãƒ¼ã‚¹èª¿æ•´ã€ãƒ¢ãƒ¼ãƒ‰ã‚’æŒã¡ã€æ®‹ä½œæ¥­/å¯ç”¨æ /åæ”¯ã‚’è¡¨ç¤ºã™ã‚‹ Resource HUD ã‚’æœ€ä¸Šæ®µã«é…ç½®ã™ã‚‹ã€‚
- æ—¥åˆ¥è² è·ã‚¹ãƒˆãƒªãƒƒãƒ—ã§ã€æ—¥åˆ¥ã®æ®‹ä½œæ¥­ã¨å¯ç”¨æ ã‚’ä¸¦åˆ—è¡¨ç¤ºã™ã‚‹ã€‚æ¨å®šæ ã¯ãƒãƒƒãƒãƒ³ã‚°ã¨è­¦å‘Šãƒãƒƒã‚¸ã§åŒºåˆ¥ã™ã‚‹ã€‚
- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€Œææ¡ˆç†ç”±ã€ã€Œå½±éŸ¿ï¼ˆä»Šé€±ã®è² è·æ¸›/æ¥é€±ã®è² è·å¢—ï¼‰ã€ã‚’æ˜ç¤ºã—ã€æ¨å¥¨æ—¥ã¸ç§»å‹•ã™ã‚‹ãƒœã‚¿ãƒ³ã¯æ—¥ä»˜å…¥ã‚Šãƒ©ãƒ™ãƒ«ã«ã™ã‚‹ã€‚
- ææ¡ˆãªã—ã®ã‚¿ã‚¹ã‚¯ã¯ Backlog ã¸æˆ»ã™æ“ä½œã®ã¿ã‚’æä¾›ã—ã€ç„¡ç†ãªæ—¥ä»˜æŒ‡å®šæ“ä½œã¯æä¾›ã—ãªã„ã€‚
- InPro ã‚¿ã‚¹ã‚¯ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é™¤å¤–ã—ã€é™¤å¤–ç†ç”±ã‚’æ³¨è¨˜ã™ã‚‹ã€‚
- Dashboard ã¯ `today` ã‚¯ã‚¨ãƒªæŒ‡å®šãŒã‚ã‚‹å ´åˆã€åŸºæº–æ—¥ã‚’æŒ‡å®šæ—¥ã«ä¸Šæ›¸ãã™ã‚‹ã€‚

```ditaa
+------------------------------------------------------------------------------------------------------+
| Resource HUD: This Week (Remaining/Capacity/Balance) | Next Week (Confirmed + Estimated)            |
+------------------------------------------------------------------------------------------------------+
| Daily Load Strip: Today â†’ Sun, Next Mon â†’ Thu (Estimated days show âš  Est)                            |
+------------------------------------------------------------------------------------------------------+
| Action Table: Overdue/Overflow -> Proposal + Reason + Impact + Action (Move to MM/DD)               |
+------------------------------------------------------------------------------------------------------+
```

```text
+----------------------------------------------------------------------------------------------------------------------------+
|  [Header]                                                                                                                  |
|  Week 45 ãƒªã‚½ãƒ¼ã‚¹èª¿æ•´                                                               [ â†¶ Undo (ç›´å‰ã®æ“ä½œã‚’æˆ»ã™) ]      |
+----------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                            |
|  [SECTION A: RESOURCE HUD]                                                                                                 |
|  +-------------------------------------------------------+      +-------------------------------------------------------+  |
|  |  THIS WEEK (æ®‹ã‚Š2æ—¥)                                  |      |  NEXT WEEK (11/13 - 11/19)                            |  |
|  |  æ®‹ä½œæ¥­ :   8.5 h  (å†… InPro: 2.0h)                   |  >>  |  å—å…¥å¯èƒ½æ  :  18.0 h                                 |  |
|  |  å¯ç”¨æ  :   4.0 h  (ç¢ºå®šæ¸ˆ)                           |      |  [ ç¢ºå®š: 6.0h ]  +  [ æ¨å®š: 12.0h (////) ] âš         |  |
|  |  ---------------------------------------------------  |      |  ---------------------------------------------------  |  |
|  |  åæ”¯   :   [ â– â–  -4.5 h (OVERFLOW) ]                  |      |  ç©ºãæ      :  [ â– â– â– â– â– â–  14.0 h ] (âš  æ¨å®šå«ã‚€)       |  |
|  +-------------------------------------------------------+      +-------------------------------------------------------+  |
|                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                            |
|  [SECTION B: DAILY LOAD STRIP]                                                                                             |
|                                                                                                                            |
|  [Today: Fri]   [Sat]      [Sun]        |   [Mon]      [Tue]      [Wed]      [Thu]                                         |
|  +----------+   +--------+ +--------+   |   +--------+ +--------+ +--------+ +--------+                                    |
|  |  11/10   |   | 11/11  | | 11/12  |   |   | 11/13  | | 11/14  | | 11/15  | | 11/16  |                                    |
|  | [OVER!]  |   | [FULL] | | [OK]   |   |   | [FREE] | | [FREE] | | [OK]   | | [FREE] |                                    |
|  | Cap:2.0h |   | Cap:2h | | Cap:4h |   |   | Cap:2h | | Cap:?? | | Cap:?? | | Cap:?? |                                    |
|  +----------+   +--------+ +--------+   |   +--------+ +--------+ +--------+ +--------+                                    |
|  |  Rem:5h  |   | Rem:2h | | Rem:1h |   |   | Rem:0h | | Rem:0h | | Rem:1h | | Rem:0h |                                    |
|  | [â– â– â– â– â– ]  |   | [â– â– ]   | | [â– ]    |   |   |        | | [â–‘â–‘â–‘â–‘] | | [â– â–‘â–‘â–‘] | | [â–‘â–‘â–‘â–‘] |                                    |
|  | [â– â– â– â– â– ]  |   | [â– â– ]   | | [â– ]    |   |   |        | | [â–‘â–‘â–‘â–‘] | | [â– â–‘â–‘â–‘] | | [â–‘â–‘â–‘â–‘] |                                    |
|  |          |   |        | |        |   |   |        | |  âš Est  | |  âš Est  | |  âš Est  |                                    |
|  +----------+   +--------+ +--------+   |   +--------+ +--------+ +--------+ +--------+                                    |
|                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                            |
|  [SECTION C: ACTION TABLE]                                                                                                 |
|  â€» é€²è¡Œä¸­ (InPro) ã®ã‚¿ã‚¹ã‚¯ã¯ã“ã“ã«ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚                                                                       |
|                                                                                                                            |
|  â–¼ 1. DEADLINE VIOLATION & OVERFLOW                                                                                        |
|  +----------------------------------------------------------------------------------------------------------------------+  |
|  |  TASK (REM)          |  STATUS             |  PROPOSAL (REASON)              |  IMPACT               |  ACTION       |  |
|  +----------------------+---------------------+---------------------------------+-----------------------+---------------+  |
|  |  è‹±èª é•·æ–‡ (2.5h)    |  [OnHold] æ˜¨æ—¥æœŸé™  |  æ¨å¥¨: 11/14(ç«)                |  ä»Šé€±: -2.5h(è² è·æ¸›)  | [ 11/14ã¸ç§»å‹• ]| |
|  |                      |                     |  ç†ç”±: è‹±èªãªã—ãƒ»ç©ºãæœ€å¤§       |  æ¥é€±: +2.5h(âš æ¨å®š)   |               |  |
|  +----------------------+---------------------+---------------------------------+-----------------------+---------------+  |
|  |  æ•°å­¦ ç©åˆ† (3.0h)    |  [Today] æœ¬æ—¥è¶…é   |  æ¨å¥¨: 11/13(æœˆ)                |  ä»Šé€±: -3.0h(è² è·æ¸›)  | [ 11/13ã¸ç§»å‹• ]| |
|  |                      |                     |  ç†ç”±: ç¢ºå®šæ å†…ã§åå®¹å¯èƒ½       |  æ¥é€±: +3.0h(ç·‘)      |               |  |
|  +----------------------+---------------------+---------------------------------+-----------------------+---------------+  |
|  |  åŒ–å­¦ æ¼”ç¿’ (4.0h)    |  [Today] æ˜¨æ—¥æœŸé™   |  âš  ææ¡ˆãªã— (ç©ºãæ ä¸è¶³)        |  ä»Šé€±: è¨ˆç”»é™¤å¤–       | [ Backlogã¸ ] |  |
|  |                      |                     |  ç†ç”±: æ¥é€±å…¨ã¦ã®æ ã«å…¥ã‚Šã¾ã›ã‚“ |  æ¥é€±: å¤‰æ›´ãªã—       |               |  |
|  +----------------------+---------------------+---------------------------------+-----------------------+---------------+  |
|                                                                                                                            |
|  [ ä¸€æ‹¬æ“ä½œã‚¨ãƒªã‚¢ ]                                                                                                        |
|  ------------------------------------------------------------------------------------------------------------------------  |
|  [âš¡ æ¨å¥¨æ—¥ã¸ä¸€æ‹¬å¤‰æ›´ (2ä»¶)]      (â€»ã€Œææ¡ˆãªã—ã€ã®åŒ–å­¦æ¼”ç¿’ã¯å¯¾è±¡å¤–ã§ã™)                                                   |
|                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------+
```

#### Settings Panel over KanbanView

- `Settings Panel` ã¯ KanbanView ã‚„ DashboardView ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤ºã™ã‚‹

```ditaa
+---------------------------------------------------------------------------------------------+
| +--------------------------------+ MM-DD HH:MM] [Kanban | Dashboard] [sync status] [avatar] |
+ | Settings Panel                 | ---------------------------------------------------------+
| |                                | sks | Estimate/Done Time                        [ğŸ…]    |
+ |                                | -+---------------+-------------+------------+------------+
| |                                |  |  InPro        |  OnHold     |   Done     | Won't fix  |
| |                                | -+---------------+-------------+------------+------------|
| |                                | +|+-------------+|+-----------+|+----------+|+----------+|
| |                                | |||             |||           |||          |||          ||
| |                                | +||             ||+-----------+|+----------+|+----------+|
| |                                | +||             ||             |+----------+|            |
| |                                | |||             ||             ||          ||            |
| |                                | +||             ||             |+----------+|            |
| |                                | +||             ||             |            |            |
| |                                | |||             ||             |            |            |
| |                                | +|+-------------+|             |            |            |
| |                                | -+---------------+-------------+------------+------------|
| |                                | +|               |             |            |            |
| |                                | ||               |             |            |            |
| |                                | +|               |             |            |            |
| |                                |  |               |             |            |            |
| |                                | -+---------------+-------------+------------+------------|
| |                                |  |               |             |            |            |
| +--------------------------------+  |               |             |            |            |
+---------++-----------++-------------+---------------+-------------+------------+------------+
```

## Requirements Traceability

| Requirement | Summary | Components | Interfaces | Flows |
|-------------|---------|------------|------------|-------|
| 1.1 | å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ã¨æ•™ç§‘è¡Œã§ãƒœãƒ¼ãƒ‰æ§‹æˆ | KanbanBoard, TaskStore | StatusPolicy | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 1.2 | ã‚¹ãƒ—ãƒªãƒ³ãƒˆ1é€±å›ºå®šã§é–‹å§‹/çµ‚äº†æ—¥è¡¨ç¤º | SprintSelector, Dashboard | TaskStore | - |
| 1.3 | åˆæœŸè¡¨ç¤ºã¯ã‚«ãƒ³ãƒãƒ³ã®ã¿ | AppShell, KanbanBoard | Router | - |
| 1.4 | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ãƒ­ãƒƒã‚¯ | KanbanBoard | StatusPolicy | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 1.5 | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºåè¨­å®šã®ã¿è¨±å¯ | SettingsStore | Settings API | - |
| 1.6 | æ•™ç§‘é †å¤‰æ›´ã‚’ã‚¹ãƒ—ãƒªãƒ³ãƒˆå˜ä½ä¿å­˜ | TaskStore | StorageAdapter | - |
| 1.7 | ã‚¿ã‚¹ã‚¯ã‚ã‚‹æ•™ç§‘ã¯å‰Šé™¤ä¸å¯ | TaskStore | StatusPolicy | - |
| 1.8 | Backlog ãƒ—ãƒ©ã‚¹ã§ä½œæˆãƒ€ã‚¤ã‚¢ãƒ­ã‚° | KanbanBoard, TaskDialog | - | - |
| 1.9 | ç©ºã‚»ãƒ«ãƒ‰ãƒ©ãƒƒã‚°ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼†ãƒ˜ãƒƒãƒ€ãƒ¼å›ºå®š | KanbanBoard | - | - |
| 2.1 | æ–°è¦ TDialog ã§å±æ€§å…¥åŠ›ä¿å­˜ï¼ˆå„ªå…ˆåº¦ã¯ D&D ã§å¤‰æ›´ï¼‰ | TaskDialog | TaskStore | - |
| 2.2 | æ—¢å­˜ Task èª­è¾¼ç·¨é›†ä¿å­˜ | TaskDialog | TaskStore | - |
| 2.3 | TCard ã«ã‚¿ã‚¤ãƒˆãƒ«/æœŸæ—¥/äºˆå®š/å®Ÿç¸¾/ã‚²ãƒ¼ã‚¸ | TaskCard | TimeCalc | - |
| 2.4 | ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã‚¿ã‚¤ãƒˆãƒ«ã«åˆæœŸãƒ•ã‚©ãƒ¼ã‚«ã‚¹ | TaskDialog | - | - |
| 2.5 | Tab ç§»å‹• | TaskDialog | - | - |
| 2.6 | ä¿å­˜: Ctrl+Enter/ãƒœã‚¿ãƒ³, Esc/ã‚­ãƒ£ãƒ³ã‚»ãƒ« | TaskDialog | - | - |
| 2.7 | ä¿å­˜/ã‚­ãƒ£ãƒ³ã‚»ãƒ«/æ¶ˆå»æ“ä½œ | TaskDialog | TaskStore | - |
| 2.8 | æ—¥ä»˜åˆ¥å®Ÿç¸¾ç´¯ç©è¡¨ç¤º | TaskDialog | TimeCalc | - |
| 2.9 | å®Ÿç¸¾ã®æ‰‹å‹•ä¿®æ­£è¨±å¯ | TaskDialog | TaskStore | - |
| 2.10 | æ•°å€¤å…¥åŠ›ã®æ­£è¦åŒ–ã¨ 0 è£œå®Œ | TaskDialog | TaskStore | - |
| 2.11 | PT æ›´æ–°ä¸­ã® TDialog å†åˆæœŸåŒ–æŠ‘æ­¢ | TaskDialog | - | - |
| 3.1 | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹/æ•™ç§‘é–“ãƒ‰ãƒ©ãƒƒã‚°ã§ç§»å‹•ä¿å­˜ | KanbanBoard, TaskStore | StatusPolicy | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.2 | ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã«æœ‰åŠ¹ã‚»ãƒ«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ | KanbanBoard | StatusPolicy | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.3 | ã‚»ãƒ«å†…å„ªå…ˆåº¦é †ã‚½ãƒ¼ãƒˆ | KanbanBoard | PrioritySorter | - |
| 3.4 | ã‚»ãƒ«å†…ä¸¦ã³æ›¿ãˆã‚’ä¿å­˜ | TaskStore | StorageAdapter | - |
| 3.5 | ãƒã‚¦ã‚¹/ã‚¿ãƒƒãƒä¸¡æ–¹ã‚µãƒãƒ¼ãƒˆ | KanbanBoard | DnD API | - |
| 3.6 | TCard æ¨ªé•·ã€InPro æ­£æ–¹å½¢ | TaskCard | - | - |
| 3.7 | InPro ã¯å¸¸ã«1ä»¶ã§ç©ã¿ä¸Šã’ãªã— | StatusPolicy, TaskCard | - | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.8 | Today æœ€å„ªå…ˆä»¥å¤–â†’InPro ç¦æ­¢ | StatusPolicy | - | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.9 | InPro ã®ã¿1ä»¶ã€ä»–ã¯ OnHold ã¸è‡ªå‹•ç§»å‹• | StatusPolicy, TaskStore | - | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.10 | InPro/OnHold ä»¥å¤–â†’Done ç¦æ­¢ | StatusPolicy | - | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.11 | OnHoldâ†’InPro ã¯åŒä¸€æ•™ç§‘ã®å…ˆé ­ã®ã¿è¨±å¯ | StatusPolicy | - | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.12 | InPro ã®ç½®æ›ã¯é€€é¿ã‚¿ã‚¹ã‚¯ã‚’ OnHold å…ˆé ­ã¸æŒ¿å…¥ã—å†æ¡ç•ª | StatusPolicy, TaskStore | - | ã‚¿ã‚¹ã‚¯ç§»å‹• |
| 3.13 | Today/InPro/OnHold æ®‹ã‚Šæ™‚é–“è¶…éã§è­¦å‘Š | AlertToast, Availability, TimeCalc | - | - |
| 3.14 | InPro è‡ªå‹•è¨ˆæ¸¬ï¼‹å††å½¢ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ | PomodoroTimer, TaskCard | TimeCalc | - |
| 3.15 | PT æ“ä½œã¨é€šçŸ¥ | PomodoroTimer, AlertToast | - | - |
| 3.16 | PT çµ‚äº†æ™‚ã‚¢ãƒ©ãƒ¼ãƒ  | PomodoroTimer, AlertToast | - | - |
| 3.17 | PT é–‹å§‹/å†é–‹ã® ğŸ… ãƒœã‚¿ãƒ³ã¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ | PomodoroTimer, KanbanBoard | - | - |
| 3.18 | PT åœæ­¢/ãƒªã‚»ãƒƒãƒˆã§ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤çµ‚äº† | PomodoroTimer, KanbanBoard | - | - |
| 3.19 | PT ãƒ•ã‚§ãƒ¼ã‚ºè‰²åˆ†ã‘ã¨ã‚²ãƒ¼ã‚¸æ›´æ–° | PomodoroTimer, KanbanBoard | - | - |
| 4.1 | Dashboard ã§é€±æ¬¡é›†è¨ˆã‚’è¡¨ç¤º | Dashboard | Burndown | - |
| 4.2 | ä»Šæ—¥æœŸæ—¥ Backlog å¼·èª¿ | KanbanBoard | TimeCalc | - |
| 4.3 | æœŸæ—¥è¶…éãƒ•ãƒ©ã‚°/ãƒªã‚¹ãƒˆ | Dashboard | TimeCalc | - |
| 4.4 | ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ãƒãƒ£ãƒ¼ãƒˆ | Dashboard | Burndown | - |
| 4.5 | æœˆæ›œå§‹ã¾ã‚Šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é¸æŠ | PlanView | Router | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ•ãƒ­ãƒ¼ |
| 4.6 | Calendar äºˆå®šå–å¾—ã—è¡¨ç¤ºï¼ˆå­¦ç¿’å¯èƒ½æ™‚é–“ã¯è‡ªå‹•åæ˜ ã—ãªã„ï¼‰ | PlanView | CalendarAdapter, Availability | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ•ãƒ­ãƒ¼ |
| 4.7 | LPK ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æ›´æ–°ã‚’ Google Calendar ã«åæ˜  | PlanView | CalendarAdapter | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ•ãƒ­ãƒ¼ |
| 4.8 | ç‰¹å®šæ—¥ãƒ“ãƒ¥ãƒ¼ã§3ç¨®ã®ã‚¿ã‚¹ã‚¯ä¸€è¦§ | PlanView | TaskStore | - |
| 4.9 | æ›œæ—¥ã”ã¨ã®ä½œæ¥­å¯èƒ½æ™‚é–“ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | Availability | SettingsStore | - |
| 4.10 | ç‰¹å®šæ—¥ä¸Šæ›¸ã | Availability | TaskStore | - |
| 4.11 | äºˆå®šã‚’è¡¨ç¤ºã—ã¦å­¦ç¿’å¯èƒ½æ™‚é–“èª¿æ•´ã®å‚è€ƒã«ã™ã‚‹ï¼ˆè‡ªå‹•åæ˜ ãªã—ï¼‰ | Availability | CalendarAdapter | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ•ãƒ­ãƒ¼ |
| 4.12 | å½“æ—¥ã®äºˆå®šã¨ã€æ‰‹å…¥åŠ›ã®å­¦ç¿’å¯èƒ½æ™‚é–“ã«åŸºã¥ãæ®‹ã‚Šå­¦ç¿’å¯èƒ½æ™‚é–“ã‚²ãƒ¼ã‚¸è¡¨ç¤º | KanbanBoard | Availability, TimeCalc | - |
| 4.13 | æ•™ç§‘åˆ¥å®Œäº†æ•°/æ™‚é–“ã®é€±æ¬¡ã‚µãƒãƒª | Dashboard | Burndown, TimeCalc | - |
| 4.14 | å½“æ—¥è¿½åŠ ã‚¿ã‚¹ã‚¯ã®ã¿è¡¨ç¤º | PlanView | TaskStore | - |
| 4.15 | ãƒ˜ãƒ«ãƒ—ãƒšãƒ¼ã‚¸æä¾›ï¼ˆSettingsPanel ã‹ã‚‰èµ·å‹•ï¼‰ | HelpPage, SettingsPanel | Router | - |
| 4.16 | äºˆå®š/å®Ÿç¸¾æ™‚é–“ã‚°ãƒ©ãƒ•è¡¨ç¤º | PlanView | TimeCalc | - |
| 4.17 | ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³æ—¥æ¬¡æ®‹å·¥æ•°ã‚’è¨˜éŒ²ã—ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã§å†ç¾ | Burndown, TaskStore | StorageAdapter | - |
| 4.18 | é¸æŠé€±ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã¨æ—¥ä»˜ãƒ“ãƒ¥ãƒ¼åæ˜  | PlanView | - | - |
| 4.19 | æ—¥ä»˜ãƒ“ãƒ¥ãƒ¼ã®4ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ç©ºçŠ¶æ…‹ | PlanView | TaskStore | - |
| 4.20 | å­¦ç¿’å¯èƒ½æ™‚é–“ã®æ—¥åˆ¥ä¸Šæ›¸ãä¿æŒ | Availability | TaskStore | - |
| 4.21 | äºˆå®šã‚¿ã‚¤ãƒˆãƒ«å¿…é ˆã§é¸æŠæ—¥åŸºæº–ã®ç™»éŒ² | PlanView | CalendarAdapter | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ•ãƒ­ãƒ¼ |
| 4.22 | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³äºˆå®šè¿½åŠ ã®æ‹’å¦ã¨ã‚¨ãƒ©ãƒ¼è¡¨ç¤º | PlanView | CalendarAdapter | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ•ãƒ­ãƒ¼ |
| 4.23 | äºˆå®šä¸€è¦§ã¨ç©ºçŠ¶æ…‹è¡¨ç¤º | PlanView | CalendarAdapter | - |
| 4.24 | æ•™ç§‘åˆ¥ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é›†è¨ˆã®è¡¨ç¤ºé † | Dashboard | TaskStore | - |
| 4.25 | é€±æ¬¡ã‚µãƒãƒªã®å®Œäº†ä»¶æ•°/å®Ÿç¸¾æ™‚é–“è¡¨ç¤º | Dashboard | Burndown, TimeCalc | - |
| 4.26 | ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ä¸€è¦§ã®æ—¥ä»˜æ˜‡é †è¡¨ç¤º | Dashboard | Burndown | - |
| 5.1 | PWA ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ä¸»è¦ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ | AppShell, ServiceWorker | UpdateManager | - |
| 5.2 | GitHub Pages é…ä¿¡ | Build/Hosting | - | - |
| 5.3 | Google ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã§ Drive ä¿å­˜ | Auth, DriveAdapter | SyncEngine | - |
| 5.4 | ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‹éšæ™‚/å®šæœŸåŒæœŸ | TaskStore, SyncEngine | StorageAdapter | åŒæœŸãƒ•ãƒ­ãƒ¼ |
| 5.5 | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ“ä½œã¨å†æ¥ç¶šåŒæœŸ | TaskStore, SyncEngine | StorageAdapter | åŒæœŸãƒ•ãƒ­ãƒ¼ |
| 5.6 | åŒæœŸçŠ¶æ…‹ã®éãƒ¢ãƒ¼ãƒ€ãƒ«é€šçŸ¥ã¨å†è©¦è¡Œ | AlertToast, SyncEngine | - | åŒæœŸãƒ•ãƒ­ãƒ¼ |
| 5.7 | ã‚µãƒ¼ãƒãƒ¬ã‚¹æ§‹æˆï¼ˆPagesï¼‹Driveï¼‰ | Architecture | - | - |
| 5.8 | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ã¨è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ | UpdateManager | ServiceWorker | æ›´æ–°ãƒ•ãƒ­ãƒ¼ |
| 5.9 | å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ | UpdateManager | ServiceWorker | æ›´æ–°ãƒ•ãƒ­ãƒ¼ |
| 5.10 | Drive è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã¯å°‚ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | DriveAdapter | - | - |
| 5.11 | å°†æ¥ã® API æ‹¡å¼µæ€§ | SyncEngine, TaskStore | Ports | - |
| 5.12 | gh ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä¿è­·/ãƒãƒ¼ã‚¸æ–¹å¼/Pages è¨­å®š | RepoSetupScript | GitHub API | - |
| 5.13 | ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ | SyncEngine, DriveAdapter, StorageAdapter | - | - |
| 6.1 | é–²è¦§å°‚ç”¨ãƒªãƒ³ã‚¯/æ¨©é™ | ReadOnlyView, Auth | Router | - |
| 6.2 | é–²è¦§å°‚ç”¨ PWA ãƒ¢ãƒ¼ãƒ‰ | ReadOnlyView | ServiceWorker | - |
| 6.3 | é–²è¦§ãƒ¢ãƒ¼ãƒ‰ã®è‡ªå‹•æ›´æ–°/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³è¡¨ç¤º | ReadOnlyView, SyncEngine | StorageAdapter | åŒæœŸãƒ•ãƒ­ãƒ¼ |
| 6.4 | æ‹›å¾…ç„¡åŠ¹åŒ–ã§é–²è¦§é®æ–­ | Auth, Router | - | - |
| 7.1 | i18n åŸºç›¤ï¼ˆ`ja-JP` å›ºå®šï¼‰ | AppShell, i18n | - | - |
| 7.2 | è¨­å®šæ°¸ç¶š | SettingsStore | StorageAdapter | - |
| 8.1 | main push ã§è‡ªå‹•ãƒ†ã‚¹ãƒˆ | CI | - | - |
| 8.2 | ãƒ†ã‚¹ãƒˆæˆåŠŸã§ãƒ“ãƒ«ãƒ‰ | CI | - | - |
| 8.3 | ãƒ“ãƒ«ãƒ‰æˆåŠŸã§ Pages ãƒ‡ãƒ—ãƒ­ã‚¤ | CI | - | - |
| 8.4 | ãƒ‡ãƒ—ãƒ­ã‚¤çµæœé€šçŸ¥ | CI | - | - |

## Components and Interfaces

### Summary Table
| Component | Domain/Layer | Intent | Req Coverage | Key Dependencies (P0/P1) | Contracts |
|-----------|--------------|--------|--------------|--------------------------|-----------|
| AppShell | UI | ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã‚·ã‚§ãƒ«ã€é–²è¦§ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ | 1.3,6.1,7.1 | Router (P0), ServiceWorker (P1) | State |
| KanbanBoard | UI | æ•™ç§‘Ã—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚°ãƒªãƒƒãƒ‰ã¨ DnD | 1.x,3.x,4.2,4.12,3.17-3.19 | StatusPolicy (P0), TaskStore (P0), DnD Kit (P1) | State |
| TaskCard | UI | ã‚¿ã‚¹ã‚¯è¡¨ç¤ºï¼ˆã‚²ãƒ¼ã‚¸/å††å½¢ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ï¼‰ | 2.3,3.6,3.12,3.14 | TimeCalc (P0), PomodoroTimer (P1), InProAutoTracker (P0) | State |
| TaskDialog | UI | ä½œæˆ/ç·¨é›†/æ¶ˆå»ã¨å…¥åŠ›åˆ¶å¾¡ | 1.8,2.x | TaskStore (P0) | Service |
| Dashboard | UI | é€±æ¬¡é›†è¨ˆãƒ»ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ | 4.1,4.3,4.4,4.13,4.24-4.26 | Burndown (P0) | State |
| SettingsPanel | UI | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºåã‚’è¨­å®šã—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹ã€PT ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ™‚é–“ã€æ‰‹å‹•åŒæœŸã€ãƒ˜ãƒ«ãƒ—å°ç·šã‚’æä¾› | 1.5,5.8,5.9,5.14,3.13,5.6,4.15 | TaskStore (P0), UpdateManager (P1), SyncEngine (P1) | State |
| PlanView | UI | æœˆæ›œå§‹ã¾ã‚Šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨äºˆå®š/å­¦ç¿’æ™‚é–“è¡¨ç¤º | 4.5-4.23 | CalendarAdapter (P0), Availability (P0) | State |
| HelpPage | UI | æ“ä½œèª¬æ˜ | 4.15 | - | - |
| AlertToast | UI | éãƒ¢ãƒ¼ãƒ€ãƒ«é€šçŸ¥ï¼ˆãƒˆãƒ¼ã‚¹ãƒˆ: åŒæœŸ/PT/éè² è·ï¼‰ | 3.11,3.13,3.15,3.16,4.6,5.6,5.8 | SyncEngine (P0), TimeCalc (P0) | State |
| TaskStore | State | ã‚¿ã‚¹ã‚¯/æ•™ç§‘/ã‚¹ãƒ—ãƒªãƒ³ãƒˆçŠ¶æ…‹ã¨ IndexedDB æ°¸ç¶š | å…¨èˆ¬ | StorageAdapter (P0), SyncEngine (P0) | State |
| StatusPolicy | Domain | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ã‚¬ãƒ¼ãƒ‰ã¨å‰¯ä½œç”¨è¨ˆç®— | 1.4,3.x | - | Service |
| PrioritySorter | Domain | ã‚»ãƒ«å†…å„ªå…ˆåº¦ï¼ˆä¸¦ã³é †ï¼‰æ­£è¦åŒ– | 3.3,3.4 | TaskStore (P1) | Service |
| InProAutoTracker | Domain | InPro æ»åœ¨ä¸­ã®è‡ªå‹•å®Ÿç¸¾åæ˜  | 3.12 | TaskStore (P0) | Service |
| TimeCalc | Domain | æ®‹ã‚Šæ™‚é–“è¨ˆç®—ã¨ Today è² è· | 2.3,3.11,4.2,4.12 | TaskStore (P1) | Service |
| Burndown | Domain | ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³è¨ˆç®—ã¨é€±æ¬¡ã‚µãƒãƒª | 4.1,4.4,4.13,4.17,4.26 | TaskStore (P1) | Service |
| Availability | Domain | å­¦ç¿’å¯èƒ½æ™‚é–“ï¼ˆäºˆå®š/ä¸Šæ›¸ã/æ›œæ—¥ï¼‰è¨ˆç®— | 4.6,4.9-4.12,4.20 | CalendarAdapter (P1), SettingsStore (P1) | Service |
| PomodoroTimer | Domain | PT è¨ˆæ¸¬ã¨é€šçŸ¥ | 3.12-3.19 | AlertToast (P1) | Service |
| SyncEngine | Sync | ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã®åŒæ–¹å‘åŒæœŸ | 5.3-5.6,6.3 | DriveAdapter (P0), CalendarAdapter (P0), StorageAdapter (P0) | Service |
| BackupService | Sync | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å–å¾—ãƒ»ä¿æŒãƒ»å¾©å…ƒ | 5.13 | DriveAdapter (P0), StorageAdapter (P0) | Service |
| DriveAdapter | Integration | Drive API å‘¼ã³å‡ºã— | 5.3,5.10 | Auth (P0) | API |
| CalendarAdapter | Integration | Calendar API å‘¼ã³å‡ºã— | 4.6-4.12,4.21-4.23 | Auth (P0) | API |
| StorageAdapter | Infra | IndexedDB CRUD | 5.4,5.5 | - | Service |
| UpdateManager | Infra | ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œçŸ¥ã¨å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ | 4.1,5.8,5.9 | ServiceWorker (P0) | Service |
| Auth | Infra | Google èªè¨¼ã¨ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç† | 5.3,6.1 | Google OAuth (P0) | Service |
| CI | Tooling | CI/CD ã®å®Ÿè¡ŒåŸºç›¤ | 8.x | - | - |
| RepoSetupScript | Tooling | gh ã‚³ãƒãƒ³ãƒ‰ã§ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ»ãƒãƒ¼ã‚¸æ–¹å¼ãƒ»Pages è¨­å®šã‚’é©ç”¨ | 5.12 | GitHub API (P0) | Service |

### UI Layer

**View Mode ç®¡ç†**
- ã‚½ãƒ¼ã‚¹: AppShell/Router ãŒ Auth å®Œäº†å¾Œã«å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆ`dataFolderId`ï¼‰ã¸ã®æ¨©é™ã‚’ç¢ºèªã— `viewMode: 'editable' | 'readonly'` ã‚’æ±ºå®šã™ã‚‹ï¼ˆé–²è¦§å°‚ç”¨ã¯å…¨ç”»é¢å…±é€šã® Modeï¼‰ã€‚
  - `mode=readonly` ã¾ãŸã¯ `sharedFolderId` ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆå­¦ç¿’è€…ãŒç™ºè¡Œã—ãŸæ‹›å¾… URL ç”±æ¥ï¼‰ã€`dataFolderId = sharedFolderId` ã¨ã—ã¦ **readonly ã§å›ºå®š**ã—ã¦é–‹ãï¼ˆæ‹›å¾… URL çµŒç”±ã§ã¯ç·¨é›†ã«æ˜‡æ ¼ã—ãªã„ï¼‰ã€‚
  - æŒ‡å®šãŒç„¡ã„å ´åˆã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã® Google Drive ä¸Šã§ `/LPK/` ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆã‚¢ãƒ—ãƒªå°‚ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã‚’è§£æ±ºã—ã€èª­ã¿æ›¸ãå¯èƒ½ãªã‚‰ editable ã¨ã™ã‚‹ã€‚èª­ã¿å–ã‚Šã®ã¿ã®å ´åˆã¯ readonly ã¨ã™ã‚‹ã€‚
  - `dataFolderId` ã®æ¨©é™ç¢ºèªã¯ Drive ã® capabilityï¼ˆä¾‹: `canEdit`ï¼‰ã§åˆ¤å®šã—ã€èª­ã¿å–ã‚Šå°‚ç”¨æ¨©é™ã®å ´åˆã¯å¸¸ã« readonly ã¨ã™ã‚‹ã€‚
- ä¼æ’­: viewMode ã‚’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¾ãŸã¯ props ã§å„ç”»é¢ï¼ˆKanbanBoard/TaskDialog/PlanView/Dashboard/SettingsPanel/Availability ç­‰ï¼‰ã¸æ¸¡ã—ã€ç·¨é›†æ“ä½œã‚’ã‚¬ãƒ¼ãƒ‰ã™ã‚‹ã€‚PlanView ã§ã®äºˆå®šè¿½åŠ /æ›´æ–°ã€Availability ã®å­¦ç¿’å¯èƒ½æ™‚é–“ä¸Šæ›¸ãã€SettingsPanel ã®ãƒ©ãƒ™ãƒ«/æ›´æ–°æ“ä½œã‚‚ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚ä¸€æ–¹ã§ã€é–²è¦§è€…ã® UI æ“ä½œã¨ã—ã¦ã®ã€Œã‚¹ãƒ—ãƒªãƒ³ãƒˆé¸æŠï¼ˆ`UiSettings.currentSprintId` ã®æ›´æ–°ï¼‰ã€ã¯è¨±å¯ã™ã‚‹ï¼ˆDrive ã¸ã®æ›¸ãè¾¼ã¿ã¯è¡Œã‚ãªã„ï¼‰ã€‚
- æ°¸ç¶šåŒ–: viewMode ã¯ä¸€æ™‚çš„ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ¢ãƒ¼ãƒ‰ã§ã‚ã‚Šã€settings/sprint ã«ã¯ä¿å­˜ã—ãªã„ã€‚

#### KanbanBoard
| Field | Detail |
|-------|--------|
| Intent | æ•™ç§‘Ã—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å›ºå®šã‚°ãƒªãƒƒãƒ‰ã€DnD æ“ä½œã‚’æä¾› |
| Requirements | 1.1-1.9,3.1-3.8,4.2,4.12 |
| Contracts | State |

**Responsibilities & Constraints**
- æ§‹é€ : `AppShell[AppBar]` ã¨ `KanbanView[Header][Container]` ã‚’åˆ†é›¢ã—ã€`Container` ã¯ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®ã¿ã¨ã™ã‚‹ï¼ˆAppBar ã¨ Kanban Header ã¯å›ºå®šï¼‰ã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡Œã¯ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã«ä¸Šéƒ¨ã¸å¼µã‚Šä»˜ãã€‚
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: æ•™ç§‘åˆ—ã¯å¹…å›ºå®šã§å·¦ã«é…ç½®ã™ã‚‹ãŒ sticky ã«ã¯ã—ãªã„ã€‚ç”»é¢å¹…ãŒååˆ†ãªå ´åˆã¯æ•™ç§‘åˆ—ã‚’é™¤ãæ¨ªå¹…ã‚’å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ã§å‡ç­‰å‰²ã‚Šã€ç‹­ã„å ´åˆã¯ Today/InPro/OnHold ã‚’å›ºå®šå¹…ã€Backlog/Done/WontFix ã‚’ç›¸å¯¾çš„ã«ç‹­ã‚ã‚‹ã€‚æ¥µç«¯ã«ç‹­ã„å ´åˆã¯ãƒœãƒ¼ãƒ‰å…¨ä½“ã‚’æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã•ã›ã¦ã‚‚ã‚ˆã„ã€‚
- æœ€å°å¹…: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ã«ã¯æœ€å°å¹…ã‚’è¨­ã‘ã‚‹ï¼ˆTCard ã®ã‚¿ã‚¤ãƒˆãƒ« 10 æ–‡å­—ç¨‹åº¦ï¼‹äºˆå®š/å®Ÿç¸¾æ™‚é–“ï¼‹æœŸæ—¥ã‚’çœç•¥ã›ãšè¡¨ç¤ºã§ãã‚‹ã“ã¨ï¼‰ã€‚æœ€å°å¹…ã¯ UI å®šæ•°ï¼ˆä¾‹: `--lpk-status-col-min-width`ï¼‰ã¨ã—ã¦é›†ç´„ã™ã‚‹ã€‚
- DnD ã¯ StatusPolicy ã®åˆ¤å®šçµæœã«å¾“ã„ã€ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã«æœ‰åŠ¹ã‚»ãƒ«ã®ã¿ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã€ç„¡åŠ¹ã‚»ãƒ«ã§ã¯ãƒ‰ãƒ­ãƒƒãƒ—ã‚’å—ã‘ä»˜ã‘ãšå…ƒã®ä½ç½®ã«æˆ»ã™ã€‚
- TCard ã® DnD ä¸­ã¯ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’è¡Œã‚ãšã€ãƒ‰ãƒ­ãƒƒãƒ—å¯¾è±¡ã¯ã€Œãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹æ™‚ç‚¹ã§ DOM ä¸Šã«å­˜åœ¨ã™ã‚‹æ•™ç§‘è¡Œã€ã«é™å®šã™ã‚‹ã€‚æ¨ªæ–¹å‘ã¯ç”»é¢å¹…ã«å¿œã˜ãŸãƒªã‚µã‚¤ã‚ºã‚’å„ªå…ˆã—ã€æ¥µç«¯ã«ç‹­ã„å ´åˆã®ã¿ãƒœãƒ¼ãƒ‰å…¨ä½“ã®æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’è¨±å¯ã™ã‚‹ï¼ˆè‡ªå‹•æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã¯è¡Œã‚ãªã„ï¼‰ã€‚
- ãƒ‰ãƒ­ãƒƒãƒ—ä½ç½®ã¯æŒ¿å…¥ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆæŒ¿å…¥ãƒ©ã‚¤ãƒ³/ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ï¼‰ã‚’å¿…é ˆã¨ã—ã€ã‚«ãƒ¼ãƒ‰ã®çŸ©å½¢ï¼ˆbounding boxï¼‰ãƒ™ãƒ¼ã‚¹ã§ã€Œä¸ŠåŠåˆ†/ä¸‹åŠåˆ†ã€ã‚’åˆ¤å®šã—ã¦ `insertIndex` ã‚’æ±ºã‚ã‚‹ï¼ˆInPro ã¸ã®é·ç§»ã¯ `insertIndex=0` å›ºå®šã§ã®ã¿è¨±å¯ï¼‰ã€‚ç©ºã‚»ãƒ«ã¸ã®ãƒ‰ãƒ­ãƒƒãƒ—ã¯æœ«å°¾æŒ¿å…¥ã¨ã™ã‚‹ï¼ˆåŒä¸€ã‚»ãƒ«/åˆ¥ã‚»ãƒ«ã§åŒä¸€è¦å‰‡ï¼‰ã€‚
- ç©ºã‚»ãƒ«ãƒ‰ãƒ©ãƒƒã‚°ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è£œåŠ©ã€Backlog ãƒ—ãƒ©ã‚¹ã‹ã‚‰ TaskDialog ã‚’èµ·å‹•ã€‚
- viewMode ãŒ readonly ã®å ´åˆã¯ DnD/ãƒ€ã‚¤ã‚¢ãƒ­ã‚°èµ·å‹•ãªã©ç·¨é›†æ“ä½œã‚’ç„¡åŠ¹åŒ–ã—ã€è¡¨ç¤ºã®ã¿ã¨ã™ã‚‹ã€‚Subject è¡Œã®ä¸¦ã¹æ›¿ãˆ/è¿½åŠ /å‰Šé™¤ã‚‚ç¦æ­¢ã€‚

**Dependencies**
- Inbound: Router â€” è¡¨ç¤ºåˆ‡æ›¿ (P2)
- Outbound: StatusPolicy â€” é·ç§»å¯å¦/å‰¯ä½œç”¨å–å¾— (P0); TaskStore â€” çŠ¶æ…‹æ›´æ–° (P0); PrioritySorter â€” å„ªå…ˆåº¦ï¼ˆä¸¦ã³é †ï¼‰æ­£è¦åŒ– (P1); TimeCalc â€” ã‚²ãƒ¼ã‚¸/è­¦å‘Š (P1)
- External: dnd-kit â€” DnD å®Ÿè£… (P1)

**Implementation Notes**
- Touch: ã‚¿ãƒƒãƒã§ã® DnD ã¯ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«èª¤æ“ä½œã‚’é¿ã‘ã‚‹ãŸã‚ã€ä¸€èˆ¬çš„ãªé•·æŠ¼ã—é–‹å§‹é…å»¶ï¼ˆä¾‹: 200-300ms ç¨‹åº¦ï¼‰ã‚’è¨­å®šã—ã€ä½“é¨“ã«å¿œã˜ã¦èª¿æ•´å¯èƒ½ã«ã™ã‚‹ã€‚
- Validation: ãƒ‰ãƒ­ãƒƒãƒ—å‰ã« StatusPolicy ã®çµæœã‚’ç¢ºèªã—ã€ç„¡åŠ¹ã‚»ãƒ«/`insertIndex` ã§ã¯ãƒ‰ãƒ­ãƒƒãƒ—ã‚’ç„¡åŠ¹åŒ–ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼/ãƒã‚¤ãƒ©ã‚¤ãƒˆã§ç¤ºã™ï¼‰ã€‚è­¦å‘Šã¯ AlertToast ã¸ã€‚
- Risks: å¤§é‡ã‚«ãƒ¼ãƒ‰ã§æç”»è² è·â†’ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä¸»ä½“ã®ãŸã‚ã€Œæ•™ç§‘è¡Œï¼ˆrowï¼‰å˜ä½ã®ãƒãƒ¼ãƒãƒ£ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰ã€ã‚’ç¬¬ä¸€å€™è£œã¨ã™ã‚‹ï¼ˆæ¨ªæ–¹å‘ã¯ä»®æƒ³åŒ–ã—ãªã„ï¼‰ã€‚DnD ä¸­ã¯ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç„¡åŠ¹åŒ–ã«åŠ ãˆã€ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹æ™‚ç‚¹ã®ä»®æƒ³åŒ–ãƒ¬ãƒ³ã‚¸ï¼ˆå¯è¦–è¡Œ + overscanï¼‰ã‚’ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†ã¾ã§å›ºå®šã—ã€è¡Œã®ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã‚’æŠ‘æ­¢ã—ã¦ãƒ‰ãƒ­ãƒƒãƒ—åˆ¤å®šã¨æŒ¿å…¥ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®‰å®šåŒ–ã™ã‚‹ã€‚
- Auto æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«: å»ƒæ­¢ï¼ˆæ¥µç«¯ã«ç‹­ã„å ´åˆã®ã¿ãƒ–ãƒ©ã‚¦ã‚¶ã®æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§å¯¾å¿œã™ã‚‹ï¼‰ã€‚
- PoC: ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‹å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ã€ç”»é¢å¹…ã«å¿œã˜ãŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ãƒªã‚µã‚¤ã‚ºï¼ˆå‡ç­‰å‰²ã‚Š/å›ºå®šå¹…/ãƒœãƒ¼ãƒ‰æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è¨±å®¹ï¼‰ã‚’çµ„ã¿åˆã‚ã›ãŸã‚¹ãƒ‘ã‚¤ã‚¯ã‚’å…ˆè¡Œå®Ÿæ–½ã—ã€æ€§èƒ½å—ã‘å…¥ã‚ŒåŸºæº–ï¼ˆæ•™ç§‘ 14ã€å„ã‚»ãƒ« 35 ä»¶ã® TCardï¼‰ã§æ“ä½œãŒç ´ç¶»ã—ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

#### TaskDialog
| Field | Detail |
|-------|--------|
| Intent | ã‚¿ã‚¹ã‚¯ä½œæˆ/ç·¨é›†/æ¶ˆå»ã‚’ãƒ•ã‚©ãƒ¼ãƒ æ“ä½œã§è¡Œã†ï¼ˆå€‹åˆ¥è¿½åŠ ã¨ä¸€æ‹¬è¿½åŠ ã‚’åˆ‡æ›¿å¯èƒ½ï¼‰ |
| Requirements | 1.8,2.x |
| Contracts | Service |

**Responsibilities & Constraints**
- ã‚¿ã‚¤ãƒˆãƒ«åˆæœŸãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã€Tab ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€Ctrl+Enter/Enter ä¿å­˜ã€Esc/ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚
- å®Ÿç¸¾æ™‚é–“ã¯ `TaskActual` ã®ä¸€è¦§ã¨ã—ã¦æ‰±ã„ã€ä»¥ä¸‹ã‚’æä¾›ã™ã‚‹:
  - è¿½åŠ : `startedAt`ï¼ˆé–‹å§‹æ™‚åˆ»ï¼‰ã¨ `durationMinutes`ï¼ˆå‹‰å¼·æ™‚é–“ï¼‰ã‚’å…¥åŠ›ã—ã¦æ–°è¦ä½œæˆã™ã‚‹ã€‚
  - å¤‰æ›´: æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã® `startedAt` ã¨ `durationMinutes` ã‚’æ›´æ–°ã§ãã‚‹ï¼ˆ`updatedAt` ã¨ `updatedByDeviceId` ã‚’æ›´æ–°ã™ã‚‹ï¼‰ã€‚
  - å‰Šé™¤: æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã§ãã‚‹ï¼ˆ`deletedAt` ã‚’è¨­å®šã—ã¦ tombstone ã¨ã—ã€åŒæœŸã§ä¼æ’­ã™ã‚‹ï¼‰ã€‚
  - è¡¨ç¤º: `startedAt` ãŒå¤ã„é †ã«ã‚½ãƒ¼ãƒˆã—ã¦è¡¨ç¤ºã™ã‚‹ï¼ˆåŒä¸€ `startedAt` ã¯ `createdAt` ã®å¤ã„é †ï¼‰ã€‚
- å„ªå…ˆåº¦ã¯ TaskDialog ã§ã¯å¤‰æ›´ã›ãšã€TCard ã® D&D ã§ã®ã¿å¤‰æ›´ã™ã‚‹ã€‚æ–°è¦ Task ã¯å¯¾è±¡ã‚»ãƒ«ã®æœ€ä¸‹ä½ï¼ˆæœ€ä½å„ªå…ˆåº¦ï¼‰ã«è¿½åŠ ã™ã‚‹ã€‚
- viewMode ãŒ readonly ã®å ´åˆã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¿ã‚¹ã‚¯/ã‚¹ãƒ—ãƒªãƒ³ãƒˆ/è¨­å®š/äºˆå®šï¼‰ã¸ã®æ›¸ãè¾¼ã¿ã«é–¢ã‚ã‚‹å…¥åŠ›ã‚’ç„¡åŠ¹åŒ–ã—è¡¨ç¤ºå°‚ç”¨ã¨ã™ã‚‹ï¼ˆä¾‹å¤–: `UiSettings` ã®å¤‰æ›´ã€ã‚¹ãƒ—ãƒªãƒ³ãƒˆã®é¸æŠã€æ›´æ–°é–“éš”è¨­å®šãªã©ã®ç«¯æœ«ãƒ­ãƒ¼ã‚«ãƒ« UI è¨­å®šã¯è¨±å¯ï¼‰ã€‚
- InPro æ»åœ¨ä¸­ã®è‡ªå‹•å®Ÿç¸¾åŠ ç®—ã¯ InProAutoTracker ãŒæ‹…ã„ã€PomodoroTimer ã¨ã¯ç‹¬ç«‹é‹ç”¨ã™ã‚‹ï¼ˆPomodoro ã¯é€šçŸ¥ãƒ»ä¼‘æ†©ç®¡ç†ã«å°‚å¿µï¼‰ã€‚
- Backlog ã‹ã‚‰èµ·å‹•ã™ã‚‹å ´åˆã¯æ•™ç§‘ãŒè‡ªæ˜ãªãŸã‚ã€æ•™ç§‘å…¥åŠ›ãªã—ã§ä½œæˆã™ã‚‹ã€‚ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã§ã€Œå€‹åˆ¥è¿½åŠ ï¼ˆè©³ç´°å…¥åŠ›ï¼‰ã€ã¨ã€Œä¸€æ‹¬è¿½åŠ ï¼ˆè¤‡æ•°è¡Œãƒ†ã‚­ã‚¹ãƒˆã§1è¡Œ=1ã‚¿ã‚¹ã‚¯ã€ã‚¿ã‚¤ãƒˆãƒ«ã®ã¿ï¼‰ã€ã‚’åˆ‡æ›¿ã§ãã€é¸æŠçŠ¶æ…‹ã‚’è¨˜æ†¶ã™ã‚‹ã€‚ä¸€æ‹¬ä½œæˆå¾Œã®è©³ç´°ç·¨é›†ã¯é€šå¸¸ã® TCard ç·¨é›†ã§è¡Œã†ã€‚

**Dependencies**
- Outbound: TaskStore â€” CRUD (P0); TimeCalc â€” æ®‹ã‚Šæ™‚é–“è¨ˆç®— (P1)

**Contracts**: Service [x] / API [ ] / Event [ ] / Batch [ ] / State [ ]
```typescript
// ã‚¿ã‚¹ã‚¯ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã‚’æ‰±ã†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å‘ã‘ã‚µãƒ¼ãƒ“ã‚¹
interface TaskDialogService {
  createTask(input: TaskInput): Result<TaskId, ValidationError>; // å¿…é ˆé …ç›®ã‚’æ¤œè¨¼ã—æ–°è¦ä½œæˆ
  updateTask(taskId: TaskId, input: TaskInput): Result<void, ValidationError>; // æ—¢å­˜ã‚¿ã‚¹ã‚¯ã‚’æ›´æ–°
  deleteTask(taskId: TaskId): Result<void, Error>; // ã‚¿ã‚¹ã‚¯ã‚’æ¶ˆå»
}
```
- Preconditions: å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€æœŸæ—¥ã€æ•™ç§‘ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰ã‚’æ¤œè¨¼ã€‚
- Postconditions: TaskStore ã«åæ˜ ã—ã€å¿…è¦ãªã‚‰ `syncState.dirty` ã‚’ true ã«ã™ã‚‹ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚ã« SyncEngine ãŒ `sync()` ã‚’å®Ÿè¡Œï¼‰ã€‚

**Implementation Notes**
- Integration: ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒˆãƒ©ãƒƒãƒ—ã¨ aria-modalã€aria-labelledby ã‚’è¨­å®šã€‚
- Risks: å¤§é‡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã®å…¥åŠ›é…å»¶â†’é…å»¶ä¿å­˜ã‚’é¿ã‘å³æ™‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

#### Dashboard
| Field | Detail |
|-------|--------|
| Intent | é€±æ¬¡é›†è¨ˆã€ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ |
| Requirements | 4.1,4.3,4.4,4.13,4.24-4.26 |
| Contracts | State |

**Responsibilities & Constraints**
- ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³è¨ˆç®—ã€æœŸæ—¥è¶…éãƒªã‚¹ãƒˆã€æ•™ç§‘åˆ¥å®Œäº†/å­¦ç¿’æ™‚é–“é›†è¨ˆã€‚
- æ•™ç§‘åˆ¥ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é›†è¨ˆã¯ 1 è¡Œã§ Backlog/Today/InPro/OnHold/Done/WontFix ã®é †ã«ä»¶æ•°ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- é€±æ¬¡ã‚µãƒãƒªã¯æ•™ç§‘ã”ã¨ã«å®Œäº†ä»¶æ•°ã¨å®Ÿç¸¾æ™‚é–“ï¼ˆåˆ†ï¼‰ã‚’è¡¨ç¤ºã—ã€ç©ºã®å ´åˆã¯ 0 ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ä¸€è¦§ã¯ã‚¹ãƒ—ãƒªãƒ³ãƒˆæœŸé–“ã®æ—¥ä»˜ã‚’æ˜‡é †ã§ä¸¦ã¹ã‚‹ã€‚
- viewMode ãŒ readonly ã®å ´åˆã¯é–²è¦§ã®ã¿ã¨ã—ã€ç·¨é›†/ä¿å­˜æ“ä½œã¯æä¾›ã—ãªã„ã€‚

**Dependencies**
- Outbound: Burndown (P0); TimeCalc (P1); TaskStore (P0)

**Implementation Notes**
- Integration: ã‚°ãƒ©ãƒ•ã¯æ—¥æ¬¡ã‚µãƒãƒªã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€è¡¨ç¤ºæ™‚ã«å†è¨ˆç®—ã‚’é¿ã‘ã‚‹ã€‚
- Risks: ã‚¹ãƒ—ãƒªãƒ³ãƒˆå¢ƒç•Œè·¨ãã®é›†è¨ˆæ¼ã‚Œâ†’æ—¥ä»˜åˆ¤å®šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’å…±é€šåŒ–ã€‚

#### PlanView
| Field | Detail |
|-------|--------|
| Intent | æœˆæ›œå§‹ã¾ã‚Šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨å­¦ç¿’å¯èƒ½æ™‚é–“è¡¨ç¤ºã€äºˆå®šåŒæ–¹å‘åŒæœŸ |
| Requirements | 4.5-4.23 |
| Contracts | State |

**Responsibilities & Constraints**
- æœˆæ›œå§‹ã¾ã‚Šå›ºå®šã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§é€±ï¼ˆã‚¹ãƒ—ãƒªãƒ³ãƒˆï¼‰ã‚’é¸æŠã—ã€ç¾åœ¨è¡¨ç¤ºä¸­ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’åˆ‡æ›¿ã™ã‚‹ï¼ˆ`UiSettings.currentSprintId` ã‚’æ›´æ–°ï¼‰ã€‚viewMode=readonly ã§ã‚‚åˆ‡æ›¿ã¯è¨±å¯ã™ã‚‹ï¼ˆUI å°‚ç”¨ã®ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ï¼‰ã€‚
  - é¸æŠå…ˆã® `sprint-{sprintId}.json` ãŒ Drive ä¸Šã«å­˜åœ¨ã—ãªã„å ´åˆã€viewMode=editable ã§ã¯å¿…è¦ã«å¿œã˜ã¦ä½œæˆãƒ•ãƒ­ãƒ¼ã¸èª˜å°ã§ãã‚‹ãŒã€viewMode=readonly ã§ã¯ä½œæˆã›ãšã€Œã“ã®é€±ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆã¯æœªä½œæˆã€ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- ç‰¹å®šæ—¥ãƒ“ãƒ¥ãƒ¼ã§å®Ÿæ–½/æœŸæ—¥/è¿½åŠ ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤ºã€‚
- æ—¥ä»˜é¸æŠæ™‚ã«é¸æŠé€±ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è¡¨ç¤ºã—ã€æ—¥ä»˜ãƒ“ãƒ¥ãƒ¼ã«é¸æŠæ—¥ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- æ—¥ä»˜ãƒ“ãƒ¥ãƒ¼ã®å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯è©²å½“ãªã—ã®å ´åˆã«ç©ºçŠ¶æ…‹ï¼ˆã€Œè©²å½“ãªã—ã€ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- Google Calendar äºˆå®šã‚’å–å¾—ã—ã¦è¡¨ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ dayDefaultAvailability/å½“æ—¥ä¸Šæ›¸ãå€¤ã‚’æ‰‹å‹•èª¿æ•´ã™ã‚‹éš›ã®å‚è€ƒæƒ…å ±ã¨ã—ã¦æç¤ºï¼ˆè‡ªå‹•æ§é™¤ã¯ã—ãªã„ï¼‰ã€‚
- å­¦ç¿’å¯èƒ½æ™‚é–“ã¯é¸æŠæ—¥ã”ã¨ã®ä¸Šæ›¸ãå€¤ã‚’ä¿æŒã—ã€æœªè¨­å®šã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- LPK å´ã®äºˆå®šè¿½åŠ /æ›´æ–°ã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚ã®ã¿ CalendarAdapter çµŒç”±ã§åŒæœŸã™ã‚‹ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯è¿½åŠ /æ›´æ–°ã‚’å—ã‘ä»˜ã‘ãšã€å†è©¦è¡Œã‚’ä¿ƒã™ï¼‰ã€‚
- äºˆå®šè¿½åŠ ã¯ã‚¿ã‚¤ãƒˆãƒ«ã‚’å¿…é ˆã¨ã—ã€é¸æŠæ—¥ã‚’åŸºæº–ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ™‚åˆ»ã‚’ä»˜ä¸ã™ã‚‹ï¼ˆåˆæœŸã¯ 09:00-10:00ï¼‰ã€‚ã‚¨ãƒ©ãƒ¼æ™‚ã¯äºˆå®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ç†ç”±ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- äºˆå®šä¸€è¦§ã¯æ—¥ä»˜ã‚’ä½µè¨˜ã—ã¦è¡¨ç¤ºã—ã€äºˆå®šãŒãªã„å ´åˆã¯ç©ºçŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- viewMode ãŒ readonly ã®å ´åˆã¯äºˆå®šè¿½åŠ /ç·¨é›†ã‚’ç„¡åŠ¹åŒ–ã—ã€é–²è¦§ã®ã¿ã¨ã™ã‚‹ã€‚CalendarAdapter ã¸ã®æ›¸ãè¾¼ã¿ API ã¯å‘¼ã°ãªã„ã€‚

**Dependencies**
- Outbound: CalendarAdapter (P0); Availability (P0); TaskStore (P0); SyncEngine (P1)

**Implementation Notes**
- Integration: syncToken å¤±åŠ¹æ™‚ã¯å…¨ä»¶å†å–å¾—ã—ã€UI ã«å†å–å¾—ä¸­ã‚’è¡¨ç¤ºã€‚
- Risks: ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å·®ç•°ã«ã‚ˆã‚‹æ—¥ä»˜ãšã‚Œâ†’ UTC ä¿æŒï¼‹è¡¨ç¤ºæ™‚ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›ã€‚


#### SettingsPanel
| Field | Detail |
|-------|--------|
| Intent | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºåè¨­å®šã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹ã®ç¢ºèªã€æ‰‹å‹•åŒæœŸ/ãƒ˜ãƒ«ãƒ—å°ç·š |
| Requirements | 1.5,7.1,5.8,5.9,5.14,3.13,5.6,4.15 |
| Contracts | State |

**Responsibilities & Constraints**
- å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é›†åˆã‚’å‰æã«ã€è¡¨ç¤ºåã®ã¿ã‚’ç·¨é›†å¯èƒ½ï¼ˆè¿½åŠ /å‰Šé™¤/ä¸¦ã¹æ›¿ãˆä¸å¯ï¼‰ã€‚
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤ºã¨ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹ï¼ˆå¼·åˆ¶æ›´æ–°å«ã‚€ï¼‰ã‚’è¡¨ç¤ºã—ã€æ‰‹å‹•ã€Œæ›´æ–°ã‚’ç¢ºèªã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ UpdateManager.checkForUpdate ã‚’èµ·å‹•ã€‚æ–°ç‰ˆãŒã‚ã‚Œã° Service Worker ã‚’æ›´æ–°ã—ã€å¼·åˆ¶/é€šå¸¸ã®åˆ¥ã«å¿œã˜ã¦ `skipWaiting`/ãƒªãƒ­ãƒ¼ãƒ‰ã‚’åˆ¶å¾¡ã™ã‚‹ã€‚
- æ‰‹å‹•åŒæœŸã®ãƒˆãƒªã‚¬ãƒ¼ï¼ˆä¾‹: ã€Œä»Šã™ãåŒæœŸã€ãƒœã‚¿ãƒ³ï¼‰ã‚’æä¾›ã—ã€SyncEngine.sync ã‚’æ˜ç¤ºå®Ÿè¡Œã§ãã‚‹ã€‚
- HelpPage ã‚’é–‹ãå°ç·šã‚’æä¾›ã™ã‚‹ï¼ˆSettingsPanel ã‹ã‚‰é·ç§»/ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºï¼‰ã€‚
- `syncState.dirty` ã®å ´åˆã¯ `SyncEngine.sync()` ã‚’è©¦è¡Œã—ã€æˆåŠŸå¾Œã«ãƒªãƒ­ãƒ¼ãƒ‰ã€‚å¤±æ•—/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯ãƒªãƒ­ãƒ¼ãƒ‰ã‚’é…å»¶ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«ã€Œãƒ­ãƒ¼ã‚«ãƒ«ã« temp ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ä½œã£ã¦å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰ã€ã‚’é¸ã‚“ã å ´åˆã®ã¿åŒæœŸå‰ãƒªãƒ­ãƒ¼ãƒ‰ã‚’è¨±å¯ã™ã‚‹ã€‚
- PT ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½œæ¥­/ä¼‘æ†©æ™‚é–“ã‚’è¨­å®šå¯èƒ½ã«ã™ã‚‹ï¼ˆã‚¿ã‚¹ã‚¯å®Ÿç¸¾ã«ã¯å½±éŸ¿ã•ã›ãªã„ï¼‰ã€‚
- `deviceId` ï¼ˆç«¯æœ«ãƒ­ãƒ¼ã‚«ãƒ«è­˜åˆ¥å­ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- é€šçŸ¥ã¯å¸¸æ™‚æœ‰åŠ¹ã¨ã—ã€ON/OFF ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹è¨­å®šã¯æä¾›ã—ãªã„ã€‚
- viewMode ãŒ readonly ã®å ´åˆã¯è¡¨ç¤ºå°‚ç”¨ã¨ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ãƒ™ãƒ«/å­¦ç¿’å¯èƒ½æ™‚é–“è¨­å®š/ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/å¾©å…ƒãªã©ã®ç·¨é›†ã¯ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚ãŸã ã—ã€Œæ›´æ–°ã‚’ç¢ºèªã€ã¯è¨±å¯ã—ã€æ¤œå‡ºæ™‚ã®æ›´æ–°ãƒ»ãƒªãƒ­ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼ã¯å®Ÿè¡Œã§ãã‚‹ã€‚
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/ãƒªã‚¹ãƒˆã‚¢ UI ã‚’æä¾›ã—ã€BackupService ã‚’çµŒç”±ã—ã¦ daily/weekly ã®å–å¾—ãƒ»å¾©å…ƒã‚’å®Ÿè¡Œã™ã‚‹ï¼ˆä¸€è¦§è¡¨ç¤ºâ†’é¸æŠâ†’ç¢ºèªâ†’å®Ÿè¡Œï¼‰ã€‚å®Ÿè¡Œä¸­ã¯ SyncEngine ã®è‡ªå‹•åŒæœŸã‚’ä¸€æ™‚åœæ­¢ã—ã€é€²æ—è¡¨ç¤ºã‚’è¡Œã†ã€‚
- viewMode=readonly ã®å ´åˆã€æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/å¾©å…ƒæ“ä½œã¯ç„¡åŠ¹åŒ–ï¼ˆè¡¨ç¤ºã®ã¿ï¼‰ã¨ã™ã‚‹ã€‚
- é–²è¦§å°‚ç”¨ãƒ¢ãƒ¼ãƒ‰ã®è‡ªå‹•æ›´æ–°é–“éš”ï¼ˆDrive/Calendar ã‹ã‚‰ã® pullï¼‰ã‚’è¨­å®šå¯èƒ½ã«ã™ã‚‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 1 åˆ†ï¼‰ã€‚ã“ã®è¨­å®šã¯é–²è¦§è€…ã”ã¨ã®ãƒ­ãƒ¼ã‚«ãƒ«å°‚ç”¨ï¼ˆDrive åŒæœŸå¯¾è±¡å¤–ï¼‰ã¨ã—ã€viewMode=readonly ã§ã‚‚å¤‰æ›´ã‚’è¨±å¯ã™ã‚‹ã€‚
- é–²è¦§æ‹›å¾…ã®ç™ºè¡Œ: é–²è¦§è€…ã® Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’æŒ‡å®šã—ã¦ã€Google Drive ã® LPK ãƒ•ã‚©ãƒ«ãƒ€ã¸ **é–²è¦§ï¼ˆreaderï¼‰æ¨©é™**ã‚’ä»˜ä¸ã™ã‚‹ã€‚ä»˜ä¸å¾Œã«ã€Œæ‹›å¾… URLï¼ˆ`sharedFolderId` + `mode=readonly`ï¼‰ã€ã‚’ç”Ÿæˆã—ã‚³ãƒ”ãƒ¼ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼ˆé–²è¦§ã«ã¯ Google ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…é ˆï¼‰ã€‚
- æ‹›å¾…ç„¡åŠ¹åŒ–: ä¸Šè¨˜ã§ä»˜ä¸ã—ãŸé–²è¦§æ¨©é™ã‚’å‰Šé™¤ã—ã€æ‹›å¾… URL çµŒç”±ã®é–²è¦§ã‚’é®æ–­ã™ã‚‹ã€‚
- æ¨©é™ç®¡ç†: ä»˜ä¸ã—ãŸæ¨©é™ã® `permissionId` ä¸€è¦§ã‚’ `Settings` ã«ä¿å­˜ã—ï¼ˆåŒæœŸå¯¾è±¡ï¼‰ã€ç„¡åŠ¹åŒ–æ™‚ã¯ãã® `permissionId` ã‚’ç”¨ã„ã¦ revoke ã‚’è©¦è¡Œã™ã‚‹ï¼ˆä»–ã®å…±æœ‰è¨­å®šã¯æ„å›³ã›ãšå¤‰æ›´ã—ãªã„ï¼‰ã€‚
  - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚¢ãƒ—ãƒªå¤–ã§å…±æœ‰è¨­å®šãŒå¤‰æ›´ã•ã‚Œ `permissionId` ãŒç„¡åŠ¹/ä¸æ•´åˆã®å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€revoke ã«å¤±æ•—ã—ãŸå ´åˆã¯ Drive ã‹ã‚‰å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ã® permissions ã‚’å†å–å¾—ã—ã¦çªåˆã—ã€ã€Œç¾åœ¨ã®å…±æœ‰çŠ¶æ…‹ã€ã‚’è¡¨ç¤ºã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‰Šé™¤å¯¾è±¡ã‚’é¸æŠã§ãã‚‹ UI ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹ï¼ˆå‰Šé™¤æ“ä½œã¯ Drive ã® `permissionId` ã‚’ç”¨ã„ã¦è¡Œã†ï¼‰ã€‚
  - UX: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ™‚ã¯ã€Œå‰Šé™¤ã§ããªã‹ã£ãŸç†ç”±ï¼ˆä¾‹: æ—¢ã«å‰Šé™¤æ¸ˆã¿ã€æ¨©é™ä¸è¶³ã€åˆ¥çµŒè·¯ã®å…±æœ‰ãŒæ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§ï¼‰ã€ã‚’ UI ã«è¡¨ç¤ºã—ã€å†è©¦è¡Œå¯èƒ½ã«ã™ã‚‹ã€‚

**Dependencies**
- Outbound: TaskStore (settings æ°¸ç¶š) (P0); UpdateManager (ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ…‹) (P1)

**Implementation Notes**
- Integration: å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç©º/é‡è¤‡ä¸å¯ï¼‰ã€‚å›ºå®šé›†åˆã‹ã‚‰å¤–ã‚Œã‚‹æ›´æ–°ã¯æ‹’å¦ã€‚
- Risks: è¨­å®šå¤‰æ›´ã¨åŒæœŸç«¶åˆâ†’ settings ã¯ `updatedAt` ã§è§£æ±ºã—ã€è§£æ±ºçµæœã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦ push ã™ã‚‹ã€‚



### Domain/State Layer

#### TaskStore (Zustand + IndexedDB)
| Field | Detail |
|-------|--------|
| Intent | ã‚¿ã‚¹ã‚¯/æ•™ç§‘/ã‚¹ãƒ—ãƒªãƒ³ãƒˆ/è¨­å®šã®å˜ä¸€ä¿¡é ¼ã‚½ãƒ¼ã‚¹ |
| Requirements | å…¨èˆ¬ |
| Contracts | State |

**Responsibilities & Constraints**
- ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã¨ IndexedDB æ°¸ç¶šã€åŒæœŸçŠ¶æ…‹ï¼ˆdirtyï¼‰ã®æ›´æ–°ã€‚
- æ•™ç§‘é †/ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ãƒ™ãƒ«è¨­å®šã®ä¿å­˜ã€‚
- viewMode=readonly ã®å ´åˆã€ç·¨é›† API ã‚’ reject ã™ã‚‹ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰ã€‚Settings/Availability/Calendar ã®æ›¸ãè¾¼ã¿ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚‚åŒæ§˜ã«æ‹’å¦ã€‚
- InProAutoTracker ã¨é€£æºã—ã€InPro æ»åœ¨ä¸­ã®ã‚¿ã‚¹ã‚¯ã« 1 åˆ†åˆ»ã¿ã§å®Ÿç¸¾ã‚’è‡ªå‹•åŠ ç®—ã€‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å¾©å¸°æ™‚ã¯çµŒéå·®åˆ†ã§è£œæ­£ã—ã€é€€å‡ºæ™‚ï¼ˆä»–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¸ç§»å‹•/åˆ¥ã‚¿ã‚¹ã‚¯ãŒ InPro ã«å…¥ã‚‹/ã‚¿ãƒ–çµ‚äº†ï¼‰ã«æœ€çµ‚åŠ ç®—ã™ã‚‹ã€‚
- **moveTask å‡¦ç†æ‰‹é †ï¼ˆåŸå­æ€§ï¼‰**
  1. `MoveInput` ã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆ`from`/`to`/`priority`/`to.insertIndex` ã«åŠ ãˆã€`context` ã‚’ Availability/TimeCalc/ç¾çŠ¶æ…‹ã‹ã‚‰ç®—å‡ºï¼‰ã€‚
  2. `StatusPolicy.validateMove` ã‚’å‘¼ã³ã€è¨±å¯/æ‹’å¦ã¨ `sideEffects` ã‚’å–å¾—ã™ã‚‹ã€‚
  3. è¨±å¯ã®å ´åˆã®ã¿ã€åŒä¸€ reducer å†…ã§ã€Œç§»å‹•å¾Œã®çŠ¶æ…‹ã€ã¨ `sideEffects` ã®é©ç”¨çµæœã‚’ç”Ÿæˆã™ã‚‹ã€‚
  4. ç”Ÿæˆã—ãŸæ–°çŠ¶æ…‹ã¨ `syncState`ï¼ˆ`dirty=true`, `localGeneration++` ãªã©ï¼‰ã‚’ã€1 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ `StorageAdapter`ï¼ˆIndexedDBï¼‰ã¸ commit ã™ã‚‹ã€‚
  5. commit æˆåŠŸå¾Œã« `SyncEngine` ã¸é€šçŸ¥ã—ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚ã« `SyncEngine.sync()` ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚æ‹’å¦ã®å ´åˆã¯çŠ¶æ…‹å¤‰æ›´ã‚’è¡Œã‚ãªã„ã€‚

**Dependencies**
- Outbound: StorageAdapter (P0); SyncEngine (P0); StatusPolicy (P1); PrioritySorter (P1)

**Contracts**: State [x]
```typescript
// ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆï¼ˆSprint ã« burndownHistory ã‚’å«ã‚€ï¼‰
interface TaskStoreState {
  tasks: Record<TaskId, Task>; // ã‚¿ã‚¹ã‚¯æœ¬ä½“
  subjects: Subject[]; // æ•™ç§‘
  sprint: Sprint; // ç¾åœ¨ã‚¹ãƒ—ãƒªãƒ³ãƒˆ
	settings: UserSettings; // è¡¨ç¤ºè¨­å®šãªã©
  syncState: SyncState; // åŒæœŸçŠ¶æ…‹ï¼ˆdirty/ä¸–ä»£ãªã©ï¼‰
}
// çŠ¶æ…‹å¤‰æ›´ã®ãŸã‚ã®æ“ä½œç¾¤
interface TaskStoreActions {
  upsertTask(task: Task): void; // ä½œæˆã¾ãŸã¯æ›´æ–°ï¼ˆupsert = update or insert: å­˜åœ¨ã™ã‚Œã°æ›´æ–°ãƒ»ç„¡ã‘ã‚Œã°ä½œæˆï¼‰
  moveTask(taskId: TaskId, to: StatusSlot): Result<SideEffects, PolicyError>; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹/æ•™ç§‘ç§»å‹•ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ä½ç½®ã‚’å«ã‚€ï¼‰
  reorderTasks(subjectId: SubjectId, status: Status, order: TaskId[]): void; // ã‚»ãƒ«å†…ä¸¦ã³æ›¿ãˆï¼ˆå„ªå…ˆåº¦æ›´æ–°ï¼‰
  upsertActual(taskId: TaskId, actual: TaskActual): void; // å®Ÿç¸¾ãƒ¬ã‚³ãƒ¼ãƒ‰ã®è¿½åŠ /æ›´æ–°
  deleteActual(taskId: TaskId, actualId: TaskActualId): void; // å®Ÿç¸¾ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤ï¼ˆtombstoneï¼‰
  setSubjectOrder(subjectIds: SubjectId[]): void; // æ•™ç§‘é †ã®æ›´æ–°
}

type DriveHead = {
  etag: string;
  updatedAt: ISODateTime;
};
type SyncState = {
  dirty: boolean; // æœªåŒæœŸã®ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ãŒã‚ã‚‹
  lastSyncedAt?: ISODateTime;
  localGeneration: number; // ãƒ­ãƒ¼ã‚«ãƒ« commit ã®å˜èª¿å¢—åŠ ã‚«ã‚¦ãƒ³ã‚¿
  driveHeads: Record<string, DriveHead>; // `settings.json` ã¨ `sprint-{sprintId}.json` ã® head æƒ…å ±
  calendarSyncToken?: string; // Calendar å·®åˆ†å–å¾—ç”¨ï¼ˆå¿…è¦ãªã‚‰ï¼‰
};

// å®Ÿç¸¾æ™‚é–“ã®è¨˜éŒ²
// - è‡ªå‹•è¨ˆæ¸¬ï¼ˆInPro æ»åœ¨ï¼‰ã‚‚ã€TDialog ã§ã®è¿½è¨˜ã‚‚ã€åŒä¸€ã®ã€Œå®Ÿç¸¾ãƒ¬ã‚³ãƒ¼ãƒ‰ã€ã¨ã—ã¦æ‰±ã†ï¼ˆåŒºåˆ¥ã—ãªã„ï¼‰ã€‚
// - åŒä¸€ã‚¿ã‚¹ã‚¯ã¯è¤‡æ•°ã®å®Ÿç¸¾ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æŒã¦ã‚‹ï¼ˆåŒæ—¥/åˆ¥æ—¥ã€åˆ†å‰²å­¦ç¿’ã‚’è¡¨ç¾ã™ã‚‹ï¼‰ã€‚
// - Dashboard ã§ã€Œæ—¥ã”ã¨ã®å®Ÿç¸¾ã€ã€Œæ™‚é–“ã”ã¨ã®å®Ÿç¸¾ã€ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã€åŒæ—¥ã®å®Ÿç¸¾ã‚‚é›†ç´„ã›ãšãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ä¿æŒã™ã‚‹ã€‚
// - Drive ç«¶åˆæ™‚ã¯ã€Œãƒ¬ã‚³ãƒ¼ãƒ‰ ID ãƒ™ãƒ¼ã‚¹ã® unionã€ã§ãƒãƒ¼ã‚¸ã—ã€ç·¨é›†/å‰Šé™¤ã‚‚åæ˜ ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
type TaskActualId = string; // uuid
type DeviceId = string;
type TaskActual = {
  id: TaskActualId;
  startedAt: ISODateTime; // è¨˜éŒ²ã®é–‹å§‹ï¼ˆæ™‚é–“å¸¯é›†è¨ˆã®åŸºæº–ï¼‰
  durationMinutes: number; // 0 ã‚ˆã‚Šå¤§ãã„æ•´æ•°ï¼ˆåˆ†ï¼‰
  createdAt: ISODateTime;
  updatedAt: ISODateTime;
  updatedByDeviceId: DeviceId;
  deletedAt?: ISODateTime; // å‰Šé™¤ã¯ tombstoneï¼ˆåŒæœŸã§ä¼æ’­ã™ã‚‹ï¼‰
};

// ç›®çš„ã‚»ãƒ«ï¼ˆæ•™ç§‘Ã—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰ã¨ã€æŒ¿å…¥ä½ç½®ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ä½ç½®ï¼‰
type StatusSlot = {
  subjectId: SubjectId;
  status: Status;
  insertIndex?: number; // 0=æœ€ä¸Šä½ã€‚çœç•¥æ™‚ã¯æœ€ä¸‹ä½ã¸æŒ¿å…¥ã™ã‚‹
};

// StatusPolicy ã‹ã‚‰è¿”ã•ã‚Œã€TaskStore ãŒé©ç”¨ã™ã‚‹å‰¯ä½œç”¨ã®æœ€å°é›†åˆ
type SideEffect =
  | { kind: 'autoMoveToOnHold'; taskId: TaskId } // InPro ç½®æ›æ™‚ã« OnHold å…ˆé ­ã¸è‡ªå‹•é€€é¿
  | { kind: 'startInProTracking'; taskId: TaskId }
  | { kind: 'stopInProTracking'; taskId: TaskId }
  | { kind: 'upsertActual'; taskId: TaskId; actual: TaskActual }
  | { kind: 'normalizePriorities'; subjectId: SubjectId; status: Status } // ã‚»ãƒ«å†…é †åºã«åˆã‚ã›ã¦ priority ã‚’ã‚®ãƒ£ãƒƒãƒ—ä»˜ãã§å†æ¡ç•ª
  | { kind: 'updateBurndown'; at: ISODateTime }; // æ—¥æ¬¡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¯ 00:00:00 ã‚’ä½¿ç”¨
type SideEffects = SideEffect[];

// å‰¯ä½œç”¨ã®é©ç”¨é †åºï¼ˆåŒä¸€ reducer å†…ã§ä¸Šã‹ã‚‰é †ã«å®Ÿè¡Œï¼‰
// 1) autoMoveToOnHold / stopInProTracking â†’ 2) startInProTracking â†’ 3) upsertActual
// â†’ 4) normalizePriorities â†’ 5) updateBurndown
```

**Implementation Notes**
- Integration: IndexedDB ã‚¹ã‚­ãƒ¼ãƒã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †ã‚’æŒã¤ã€‚
- Risks: å¤§é‡ã‚¿ã‚¹ã‚¯æ™‚ã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºè² è·â†’å·®åˆ†ä¿å­˜ã¨ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆé »åº¦ã‚’èª¿æ•´ã€‚

#### StatusPolicy
| Field | Detail |
|-------|--------|
| Intent | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ã®å¯å¦åˆ¤å®šã¨å‰¯ä½œç”¨ç”Ÿæˆ |
| Requirements | 1.4,3.1-3.10 |
| Contracts | Service |

**Contracts**: Service [x]
```typescript
// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ã®å¯å¦ã¨å‰¯ä½œç”¨ã‚’åˆ¤å®š
interface StatusPolicyService {
  validateMove(input: MoveInput): MoveDecision; // è¨±å¯/æ‹’å¦ã¨å‰¯ä½œç”¨ã‚’è¿”ã™ï¼ˆç´”ç²‹åˆ¤å®šï¼‰
}
// ã‚¿ã‚¹ã‚¯ç§»å‹•ã®å…¥åŠ›ï¼ˆTaskStore ã‹ã‚‰å¿…è¦ãªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æ˜ç¤ºçš„ã«æ¸¡ã™ï¼‰
type MoveInput = {
  taskId: TaskId;
  from: { subjectId: SubjectId; status: Status; priority: number }; // Todayâ†’InPro åˆ¤å®šã«å„ªå…ˆåº¦ã‚’ä½¿ç”¨ï¼ˆToday å…ˆé ­ã®ã¿ InPro å¯ï¼‰
  to: { subjectId: SubjectId; status: Status; insertIndex?: number }; // D&D ã®ãƒ‰ãƒ­ãƒƒãƒ—ä½ç½®ï¼ˆ0=æœ€ä¸Šä½ï¼‰ã€‚çœç•¥æ™‚ã¯æœ€ä¸‹ä½ã¸æŒ¿å…¥ã— priority ã‚’æ›´æ–°ã™ã‚‹
  context: {
    hasOtherInPro: boolean; // æ—¢ã« InPro ãŒå­˜åœ¨ã™ã‚‹ã‹ï¼ˆåŒæ™‚ã« 1 ä»¶ã®ã¿ï¼‰
    todayPlannedMinutes: number; // Today ã«ç©ã¾ã‚Œã¦ã„ã‚‹äºˆå®šæ™‚é–“åˆè¨ˆ
    availableMinutesToday: number; // æœ¬æ—¥ã®å­¦ç¿’å¯èƒ½æ™‚é–“ï¼ˆAvailability çµæœï¼‰
    dueAt?: ISODateTime; // æœŸæ—¥ï¼ˆDone/WontFix ã‚¬ãƒ¼ãƒ‰ãªã©ã«åˆ©ç”¨ã€‚æ—¥ä»˜ã®ã¿ã®å ´åˆã¯ 00:00:00ï¼‰
    isTopOfOnHold?: boolean; // from.status=OnHold ã®ã¨ãå…ˆé ­ã‹ã©ã†ã‹ï¼ˆå…ˆé ­ã®ã¿ InPro é·ç§»å¯ï¼‰
    isTopOfToday?: boolean; // from.status=Today ã®ã¨ãå…ˆé ­ã‹ã©ã†ã‹ï¼ˆå…ˆé ­ã®ã¿ InPro é·ç§»å¯ï¼‰
  };
  initiator?: 'mouse' | 'touch' | 'keyboard';
};
type MoveDecision =
  | { allowed: true; sideEffects: SideEffect[] }
  | { allowed: false; reason: PolicyError };
```
- Preconditions: å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é›†åˆå¤–ã®é·ç§»ã¯å³æ‹’å¦ã€‚
- Postconditions: å‰¯ä½œç”¨ï¼ˆInPro ç½®æ›â†’å…ƒã‚’ OnHold å…ˆé ­ã¸é€€é¿ã€Done ã‚¬ãƒ¼ãƒ‰ï¼‰ã‚’è¿”å´ã€‚

**Dependencies**
- Inbound: KanbanBoard (P0)
- Outbound: ãªã—ï¼ˆTaskStore ä¾å­˜ã‚’æŒãŸãªã„ç´”ç²‹ã‚µãƒ¼ãƒ“ã‚¹ï¼‰

**Implementation Notes**
- InPro ã¸ã®é·ç§»ã¯ Today å…ˆé ­ã¾ãŸã¯ OnHold å…ˆé ­ã‹ã‚‰ã®ã¿è¨±å¯ã—ã€`insertIndex` ã¯ 0 é™å®šã€‚ãã®ä»–ã¯ `PolicyError` ã‚’è¿”ã™ã€‚
- InPro ç½®æ›æ™‚ã¯é€€é¿ã‚¿ã‚¹ã‚¯ã‚’ OnHold å…ˆé ­ã¸æŒ¿å…¥ã—ã€å½“è©²ã‚»ãƒ«ã® priority ã‚’å†æ¡ç•ªã™ã‚‹ï¼ˆToday ã®å„ªå…ˆåº¦ã¯ã‚³ãƒ”ãƒ¼ã—ãªã„ï¼‰ã€‚
- Risks: ãƒãƒªã‚·ãƒ¼æ›´æ–°æ™‚ã®ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³â†’ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå¿…é ˆã€‚

#### PrioritySorter
| Field | Detail |
|-------|--------|
| Intent | ã‚»ãƒ«å†…ã®å„ªå…ˆåº¦ï¼ˆä¸¦ã³é †ï¼‰æ­£è¦åŒ–ã¨ã‚½ãƒ¼ãƒˆ |
| Requirements | 3.3,3.4 |
| Contracts | Service |

**Implementation Notes**
- Integration: ã‚»ãƒ«å†…é †åºã®ã‚½ãƒ¼ã‚¹ã¯ `Task.priority`ï¼ˆã‚®ãƒ£ãƒƒãƒ—ä»˜ã rankï¼‰ã¨ã—ã€è¡¨ç¤ºã¯ `priority` ã®é™é †ï¼ˆåŒå€¤ã¯ `updatedAt`â†’`taskId`ï¼‰ã§æ±ºå®šã™ã‚‹ã€‚DnD ã«ã‚ˆã‚‹ä¸¦ã³æ›¿ãˆ/åˆ¥ã‚»ãƒ«ç§»å‹•ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ä½ç½®æŒ¿å…¥ï¼‰ã§ã¯ã€é€šå¸¸ã¯ã€Œç§»å‹•ã—ãŸ 1 ä»¶ã€ã® `priority` ã®ã¿ã‚’æ›´æ–°ã™ã‚‹ï¼ˆéš£æ¥ 2 ä»¶ã® `priority` ã®ä¸­é–“å€¤ã€å…ˆé ­/æœ«å°¾ã¯ `PRIORITY_STEP` ã®åŠ ç®—/æ¸›ç®—ã§ä»˜ä¸ï¼‰ã€‚æŒ¿å…¥å…ˆã§ã‚®ãƒ£ãƒƒãƒ—ãŒç„¡ã„ï¼ˆä¾‹: ä¸­é–“å€¤ãŒä½œã‚Œãªã„ï¼‰å ´åˆã‚„åŒå€¤ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€å½“è©²ã‚»ãƒ«å†…ã‚’ PrioritySorter ã§æ­£è¦åŒ–ã—ã€ä¸Šã‹ã‚‰ `0, -PRIORITY_STEP, -2*PRIORITY_STEP...` ã®ã‚ˆã†ã«ã‚®ãƒ£ãƒƒãƒ—ã‚’å†ä»˜ä¸ã™ã‚‹ã€‚
- å®šæ•°: `PRIORITY_STEP = 1024`ï¼ˆæ•´æ•°ï¼‰
- Risks: ä¸¦ã³é †ã®ç«¶åˆï¼ˆä»–ç«¯æœ«æ›´æ–°ï¼‰â†’ ç«¶åˆã§ `priority` ãŒåŒå€¤ã«ãªã£ãŸå ´åˆã¯ tie-break ã§è¡¨ç¤ºã‚’å®‰å®šåŒ–ã—ã€åŒæœŸå¾Œã«å½“è©²ã‚»ãƒ«ã®ã¿æ­£è¦åŒ–ã—ã¦åŒå€¤ã‚’è§£æ¶ˆã™ã‚‹ã€‚

#### TimeCalc
| Field | Detail |
|-------|--------|
| Intent | äºˆå®š/æ®‹ã‚Šæ™‚é–“ã€Today è² è·ã€æœŸæ—¥å¼·èª¿ã‚’è¨ˆç®— |
| Requirements | 2.3,3.11,4.2,4.12,4.16 |
| Contracts | Service |

**Implementation Notes**
- Integration: å®Ÿç¸¾ç´¯ç©ã¨äºˆå®šæ™‚é–“å·®åˆ†ã§æ®‹ã‚Šæ™‚é–“ç®—å‡ºã€‚ã‚²ãƒ¼ã‚¸è¡¨ç¤ºç”¨ã®æ¨™æº–åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ã€‚
- Risks: ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å·®ç•°â†’ãƒ‡ãƒ¼ã‚¿ã¯ UTC, è¡¨ç¤ºã®ã¿ãƒ­ãƒ¼ã‚«ãƒ«ã€‚

#### Burndown
| Field | Detail |
|-------|--------|
| Intent | ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ã¨é€±æ¬¡ã‚µãƒãƒªç®—å‡º |
| Requirements | 4.1,4.4,4.13,4.17,4.26 |
| Contracts | Service |

**Implementation Notes**
- Integration: ã‚¹ãƒ—ãƒªãƒ³ãƒˆé–‹å§‹æ—¥æ™‚ã‚’åŸºç‚¹ã«æ—¥æ¬¡æ®‹å·¥æ•°ï¼ˆä»¶/è¦‹ç©æ™‚é–“ï¼‰ã‚’ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã€‚æ®‹å·¥æ•°ã¯åŸå‰‡ã€Œ`status != Done` ã®ã‚¿ã‚¹ã‚¯ã®è¦‹ç©æ™‚é–“åˆè¨ˆã€ã¨ã—ã€Done ã¸ç§»å‹•ã—ãŸæ™‚ã«æ¸›ã‚‹ã€‚WontFix ã¯åˆ¥é›†è¨ˆï¼ˆç·šã‚’åˆ†ã‘ã‚‹/æ³¨è¨˜ã™ã‚‹ï¼‰ã¨ã—ã¦æ‰±ã†ã€‚
- æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°: `moveTask`ï¼ˆDone â‡„ é Doneï¼‰ã€`updateTask`ï¼ˆè¦‹ç©æ™‚é–“å¤‰æ›´ï¼‰ã€`applyRemote` ã®ãƒãƒ¼ã‚¸é©ç”¨å¾Œã«æ›´æ–°ã™ã‚‹ã€‚Dashboard ã‚’è¡¨ç¤ºã—ã¦ã„ãªã„é–“ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»ã‚’ä¸è¦ã¨ã—ã€Dashboard è¡¨ç¤ºæ™‚ã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ¬ æåˆ†ã®ã¿å†è¨ˆç®—ã—ã¦æ•´åˆã‚’å–ã‚‹ã€‚
- Risks: é€”ä¸­æ•™ç§‘å‰Šé™¤ä¸å¯ãƒ«ãƒ¼ãƒ«åæ˜ ã‚’å¿˜ã‚Œãªã„ã€‚

#### Availability
| Field | Detail |
|-------|--------|
| Intent | å­¦ç¿’å¯èƒ½æ™‚é–“ï¼ˆæ›œæ—¥ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‹å½“æ—¥ä¸Šæ›¸ãï¼‹äºˆå®šè¡¨ç¤ºã‚’å‚è€ƒã«ã—ãŸæ‰‹å‹•èª¿æ•´ï¼‰ |
| Requirements | 4.6,4.9-4.12,4.20 |
| Contracts | Service |

**Implementation Notes**
- Integration: `dayDefaultAvailability` ã‚’åˆæœŸå€¤ã¨ã—ã€ã‚¹ãƒ—ãƒªãƒ³ãƒˆå†…ã®æ—¥ä»˜ãŒ `Sprint.dayOverrides` ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ãã®å€¤ã§ä¸Šæ›¸ãã€‚Calendar äºˆå®šã¯è¡¨ç¤ºã®ã¿ã§ã€å­¦ç¿’å¯èƒ½æ™‚é–“ã®è¨ˆç®—ã«ã¯è‡ªå‹•åæ˜ ã—ãªã„ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰‹å‹•å…¥åŠ›ã‚’å„ªå…ˆï¼‰ã€‚
- Risks: äºˆå®šè¡¨ç¤ºã®çµ‚æ—¥/ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å‡¦ç†ï¼ˆè¡¨ç¤ºä¸Šã®å•é¡Œã®ã¿ï¼‰ã€‚
- viewMode=readonly ã®å ´åˆã€å­¦ç¿’å¯èƒ½æ™‚é–“ã®ä¸Šæ›¸ãã¯å—ã‘ä»˜ã‘ãšã€èª­ã¿å–ã‚Šã®ã¿ã¨ã™ã‚‹ã€‚

#### PomodoroTimer
| Field | Detail |
|-------|--------|
| Intent | ä½œæ¥­/ä¼‘æ†©è¨ˆæ¸¬ã¨é€šçŸ¥ï¼ˆã‚¿ã‚¹ã‚¯å®Ÿç¸¾ã¨ã¯ç‹¬ç«‹ï¼‰ |
| Requirements | 3.12-3.14 |
| Contracts | Service |

**Implementation Notes**
- Integration: AlertToast ã«é–‹å§‹/çµ‚äº†/ä¼‘æ†©çŠ¶æ…‹ã‚’é€šçŸ¥ã—ã€InProAutoTracker ã¨é€£æºã›ãšã«ç‹¬ç«‹ç¨¼åƒã™ã‚‹ï¼ˆPT ã®ä¼‘æ†©ã¯å®Ÿç¸¾ã‚’å¤‰ãˆãªã„ï¼‰ã€‚
- Risks: ãƒ–ãƒ©ã‚¦ã‚¶ã‚¹ãƒªãƒ¼ãƒ—æ™‚ã®ç²¾åº¦ä½ä¸‹â†’Service Worker ã‚¢ãƒ©ãƒ¼ãƒ ã¯ä½¿ç”¨ã›ãšã€å†é–‹æ™‚ã«çµŒéè£œæ­£ã€‚

#### InProAutoTracker
| Field | Detail |
|-------|--------|
| Intent | InPro ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ã‚¿ã‚¹ã‚¯ã«å¯¾ã—ã¦ã€æ»åœ¨ä¸­ã®çµŒéæ™‚é–“ã‚’è‡ªå‹•ã§å®Ÿç¸¾ã«åŠ ç®—ã™ã‚‹ | 3.12 |
| Contracts | Service |

**Implementation Notes**
- InPro å…¥å®¤æ™‚ã«è¨ˆæ¸¬é–‹å§‹ã—ã€InPro æ»åœ¨ã‚’ 1 ã¤ã® `TaskActual` ã¨ã—ã¦æ‰±ã†ãŒã€1 åˆ†ã”ã¨ã®é€²æ—ã¯ UI ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ï¼ˆéåŒæœŸå¯¾è±¡ï¼‰ã«ã®ã¿è“„ç©ã™ã‚‹ã€‚ä¸€å®šé–“éš”ï¼ˆä¾‹: 5 åˆ†ï¼‰ã¾ãŸã¯é€€å‡ºæ™‚ã«ã¾ã¨ã‚ã¦ `TaskActual.durationMinutes` ã‚’æ›´æ–°ã—ã€åˆã‚ã¦ `syncState.dirty` ã‚’ç«‹ã¦ã‚‹ï¼ˆ1 åˆ†åˆ»ã¿ã§ã¯ dirty ã«ã—ãªã„ï¼‰ã€‚
- InPro é€€å‡ºï¼ˆä»–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¸ç§»å‹•ã€ã¾ãŸã¯åˆ¥ã‚¿ã‚¹ã‚¯ãŒ InPro ã¸å…¥ã‚‹ï¼‰æ™‚ã«è¨ˆæ¸¬ã‚’åœæ­¢ã—ã€æœªåæ˜ ã® UI ãƒ­ãƒ¼ã‚«ãƒ«è“„ç©ã‚’ã¾ã¨ã‚ã¦åæ˜ ã—ã¦æœ€çµ‚åŠ ç®—ã‚’è¡Œã†ã€‚ã‚¿ãƒ–çµ‚äº†æ™‚ã¯ Beacon/Fallback ã§æœ€çµ‚æ›¸ãè¾¼ã¿ã‚’è©¦è¡Œã€‚
- PomodoroTimer ã¨ã¯ç‹¬ç«‹ï¼ˆPomodoro ã¯é€šçŸ¥ã¨ä¼‘æ†©ç®¡ç†ã®ã¿ï¼‰ã€‚Pomodoro ãŒåœæ­¢ä¸­ã§ã‚‚è¨ˆæ¸¬ã¯ç¶™ç¶šã—ã€ä¼‘æ†©ã¯å®Ÿç¸¾ã«å½±éŸ¿ã•ã›ãªã„ã€‚
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚åŠ ç®—ã‚’ç¶šã‘ã‚‹ãŒã€1 åˆ†åˆ»ã¿ã¯ UI ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿æŒã—ã€ãƒãƒƒãƒåæ˜ æ™‚ã®ã¿å®Ÿç¸¾ï¼ˆTask ã® `actuals`ï¼‰ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã¸æ°¸ç¶šã—ã¦ `syncState.dirty` ã‚’ true ã«ã™ã‚‹ã€‚ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¾©å¸°æ™‚ã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆåŒæœŸã§ Drive ã¸åæ˜ ã™ã‚‹ï¼ˆCalendar ã®å‚ç…§ãƒ»æ›´æ–°ã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚ã®ã¿ï¼‰ã€‚
- viewMode=readonly ã®å ´åˆã¯è¨ˆæ¸¬ã‚’é–‹å§‹ã›ãšã€æ—¢å­˜ã®å®Ÿç¸¾ã‚’æ›¸ãæ›ãˆãªã„ã€‚

#### BackupService
| Field | Detail |
|-------|--------|
| Intent | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å–å¾—ãƒ»ä¿æŒãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å¾©å…ƒã‚’è¡Œã† | 5.13 |
| Contracts | Service |

**Implementation Notes**
- ãƒˆãƒªã‚¬ãƒ¼: æ—¥æ¬¡ã¨é€±æ¬¡ã§ snapshot ã‚’ä½œæˆï¼ˆè‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ viewMode=editable ã®ã¿ã§æœ‰åŠ¹ã€‚ã‚¢ãƒ—ãƒªç¨¼åƒä¸­ã‹ã¤ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãªã‚‰ SyncEngine ãŒå®Ÿè¡Œï¼‰ã€‚å¿…è¦ã«å¿œã˜ã¦ UI ã‹ã‚‰æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½ã«ã™ã‚‹ã€‚
- ä¿æŒãƒãƒªã‚·ãƒ¼: retention ã‚¹ãƒ­ãƒƒãƒˆã‚’æ—¥æ¬¡/é€±æ¬¡ã§ç®¡ç†ï¼ˆä¾‹: daily=7 ä»¶, weekly=4 ä»¶ï¼‰ã€‚`deviceId` ã”ã¨ã«ä¸–ä»£ç®¡ç†ã—ã€å‰Šé™¤ã¯ã€ŒåŒä¸€ `deviceId` ã®åŒä¸€ typeã€ã ã‘ã‚’å¯¾è±¡ã«ã™ã‚‹ï¼ˆåˆ¥ç«¯æœ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯å‰Šé™¤ã—ãªã„ï¼‰ã€‚
- ã‚¹ã‚³ãƒ¼ãƒ—: daily ã¯ã€Œç¾è¡Œã‚¹ãƒ—ãƒªãƒ³ãƒˆ + settingsï¼ˆ+calendarEvents å¿…è¦ãªã‚‰ï¼‰ã€ã®ã¿ã‚’ä¿å­˜ã€‚weekly ã¯ã€Œå…¨ã‚¹ãƒ—ãƒªãƒ³ãƒˆ + settingsï¼ˆ+calendarEvents å¿…è¦ãªã‚‰ï¼‰ã€ã‚’ä¿å­˜ã€‚æ–°è¦ã‚¹ãƒ—ãƒªãƒ³ãƒˆç¢ºå®šç›´å¾Œã®æœ€åˆã® daily/weekly ã§å¿…ãšå½“è©²ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’å«ã‚ã‚‹ã€‚temp/manual ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ daily åŒç­‰ã‚¹ã‚³ãƒ¼ãƒ—ã ãŒã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å…¨ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’å«ã‚ã‚‰ã‚Œã‚‹ã€‚
- æ ¼ç´å½¢å¼ï¼ˆzip åˆ†å‰²ï¼‰: Drive ã® `/LPK/backups/` ã«ä»¥ä¸‹ã‚’ä¿å­˜ã™ã‚‹ã€‚  
- `common-{type}-{deviceId}-{isoDate}.zip`: settings.json, calendarEvents.jsonï¼ˆå¿…è¦ãªã‚‰ï¼‰, manifest.json ã‚’åŒæ¢±ã™ã‚‹ã€‚manifest.json ã«ã¯ `createdAt`, `type`, `deviceId`, `schemaVersion`, `appVersion`, `driveHeads`ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å–å¾—æ™‚ç‚¹ã® Drive head æƒ…å ±ï¼‰ã¨ã€å„ãƒ•ã‚¡ã‚¤ãƒ«ã® checksum/ä¸€è¦§ã‚’å«ã‚ã‚‹ã€‚type ã”ã¨ã« retentionï¼ˆdaily=7, weekly=4 ãªã©ï¼‰ã§ä¸–ä»£ã‚’ä¿æŒã—ã€ä¸Šé™è¶…éæ™‚ã«å¤ã„é †ã‹ã‚‰å‰Šé™¤ã™ã‚‹ï¼ˆåŒä¸€ `deviceId` ã®ã¿ï¼‰ã€‚  
  - `sprints-{type}-{YYYY-MM}-{deviceId}-{isoDate}.zip`: å½“è©²æœˆã«é–‹å§‹ã—ãŸé€±æ¬¡ã‚¹ãƒ—ãƒªãƒ³ãƒˆã® `sprint-{id}.json` ã‚’ã¾ã¨ã‚ãŸ zipã€‚typeï¼ˆdaily/weekly/temp/manualï¼‰ã”ã¨ã«æœˆå˜ä½ã§ä¸–ä»£ç®¡ç†ã—ã€å„ typeÃ—æœˆã§ retention ä¸Šé™ï¼ˆdaily=7, weekly=4 ãªã©ï¼‰ã‚’è¶…ãˆãŸå¤ã„ä¸–ä»£ã¯å‰Šé™¤ã™ã‚‹ï¼ˆåŒä¸€ `deviceId` ã®ã¿ï¼‰ã€‚ç¾åœ¨ã®æœˆã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ™‚ã«æ¯å›æ–°è¦ç”Ÿæˆã€éå»æœˆã¯ä¸–ä»£ä¿æŒã®ã¿ã§å†…å®¹ã¯ä¸å¤‰ï¼ˆé€±æ¬¡ãŒå¿…ãš 1 é€±å˜ä½ãªã®ã§æœˆè·¨ãã¯é–‹å§‹æœˆã«æ‰€å±ã•ã›ã‚‹ï¼‰ã€‚  
  - `{type}` ã¯ daily/weekly/tempï¼ˆå¿…è¦ã«å¿œã˜ã¦ manual è¿½åŠ ï¼‰ã€‚weekly ã¯æœ€æ–° common ã«åŠ ãˆã€å¿…è¦ãªæœˆã® `sprints-{type}-{YYYY-MM}-{deviceId}-{isoDate}.zip` ã‚’å–å¾—ã™ã‚‹ã€‚daily ã¯ç¾è¡Œã‚¹ãƒ—ãƒªãƒ³ãƒˆãŒå±ã™ã‚‹æœˆã® `sprints-{type}-{YYYY-MM}-{deviceId}-{isoDate}.zip` ã®ã¿æ›´æ–°/å–å¾—ã™ã‚‹ã€‚
- å¾©å…ƒã§è¤‡æ•°ç«¯æœ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã€`deviceId` ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã—ã¦ä¸€è¦§è¡¨ç¤ºã™ã‚‹ï¼ˆè¡¨ç¤ºã¯ `deviceId` ã®çŸ­ç¸®è¡¨ç¤ºã§ååˆ†ã¨ã™ã‚‹ï¼‰ã€‚æ¨å¥¨ã®é¸æŠã¯ã€Œ(1) manifest æ¤œè¨¼ OKï¼ˆchecksum/å±•é–‹/å¯¾å¿œ `schemaVersion`ï¼‰ã€ã€Œ(2) `createdAt` ãŒæœ€æ–°ã€ã€Œ(3) `driveHeads` ãŒç¾åœ¨ã® Drive head ã«æœ€ã‚‚è¿‘ã„ã€ã‚’å„ªå…ˆã—ã€æœ€çµ‚çš„ãªæ¡ç”¨ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã™ã‚‹ã€‚
- å¾©å…ƒãƒ•ãƒ­ãƒ¼: UI ã§ä¸€è¦§â†’é¸æŠâ†’å¾©å…ƒç¢ºèªâ†’ SyncEngine ã®è‡ªå‹•åŒæœŸã‚’ä¸€æ™‚åœæ­¢ã€‚é¸æŠã—ãŸ `common-*.zip` ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ manifest ã‚’æ¤œè¨¼ã—ã€manifest ãŒæŒ‡ã™ `sprints-*.zip` ã‚’é †æ¬¡ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å±•é–‹ã™ã‚‹ã€‚StorageAdapter çµŒç”±ã§ settings/sprint-* ã‚’ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é©ç”¨â†’ `syncState.dirty=true` ã«ã—ã¦å¾©å…ƒå®Œäº†â†’ è‡ªå‹•åŒæœŸã‚’å†é–‹â†’ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ™‚ã« `SyncEngine.sync()` ã§å†åŒæœŸã™ã‚‹ã€‚
- å¾©å…ƒæ™‚ã®å®‰å…¨ç­–: ç¾è¡ŒçŠ¶æ…‹ã‚’ä¸€æ™‚çš„ã«ãƒ­ãƒ¼ã‚«ãƒ«ã¸ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆtemp slotï¼‰ã—ã€å¤±æ•—æ™‚ã¯ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯èƒ½ã«ã™ã‚‹ã€‚
- UI èµ·ç‚¹: SettingsPanel ã‹ã‚‰ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸€è¦§å–å¾—ãƒ»æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒã‚’å®Ÿè¡Œã™ã‚‹ã€‚
- æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/å¾©å…ƒã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯å®Ÿè¡Œã›ãšã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºï¼ˆå¾Œã§è‡ªå‹•å†è©¦è¡Œã—ãªã„ï¼‰ã€‚viewMode=editable ã®å ´åˆã¯è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ç¶™ç¶šã™ã‚‹ã€‚Drive æ¨©é™ä¸è¶³æ™‚ã¯ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã—å†èªè¨¼ã‚’ä¿ƒã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨±å¯ã—ãŸå ´åˆã®ã¿èªè¨¼ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿæ–½ã—ã¦å†è©¦è¡Œã™ã‚‹ã€‚
- viewMode=readonly ã®å ´åˆã€æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/å¾©å…ƒæ“ä½œã¯ç„¡åŠ¹åŒ–ï¼ˆè¡¨ç¤ºã®ã¿ï¼‰ã¨ã™ã‚‹ã€‚
- viewMode=readonly ã®å ´åˆã€SyncEngine ã¯ Drive/Calendar ã¸ã®æ›¸ãè¾¼ã¿ã‚’è¡Œã‚ãšã€è¨­å®šã•ã‚ŒãŸé–“éš”ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 1 åˆ†ï¼‰ã§ pull ã®ã¿å®Ÿè¡Œã—ã¦è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã€‚ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯æœ€çµ‚ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’è¡¨ç¤ºã—ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¾©å¸°æ™‚ã«å³æ™‚ pull ã™ã‚‹ã€‚

#### SyncEngine
| Field | Detail |
|-------|--------|
| Intent | ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã¨ Drive/Calendar ã®åŒæ–¹å‘åŒæœŸ |
| Requirements | 5.3-5.6,6.3,5.10 |
| Contracts | Service |

**Dependencies**
- Outbound: DriveAdapter (P0); CalendarAdapter (P0); StorageAdapter (P0); TaskStore (P0)

**Contracts**: Service [x]
```typescript
// Drive/Calendar ã¨ã®åŒæœŸï¼ˆã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ pull/merge/pushï¼‰ã‚’å¸ã‚‹
interface SyncEngine {
  sync(): Promise<SyncResult>; // pullâ†’mergeâ†’pushï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰
  applyRemote(remote: RemoteSnapshot): Promise<MergeResult>; // ãƒªãƒ¢ãƒ¼ãƒˆå·®åˆ†ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã¸ãƒãƒ¼ã‚¸ï¼ˆWeb Worker ã‚’å«ã‚€ãŸã‚éåŒæœŸï¼‰
}
```
- Preconditions: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯ push ã‚’è¡Œã‚ãšã€pull ã‚‚å¿…è¦æ™‚ã®ã¿è¡Œã†ã€‚
- Postconditions: æˆåŠŸæ™‚ã« lastSyncedAt/ä¸–ä»£ ID ã‚’æ›´æ–°ã—ã€dirty ã‚’ false ã«ã™ã‚‹ã€‚å¤±æ•—æ™‚ã¯å†è©¦è¡Œå¯èƒ½ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿”å´ã€‚

**Implementation Notes**
- Integration: syncToken å¤±åŠ¹æ™‚ã®ãƒ•ãƒ«ãƒªãƒ­ãƒ¼ãƒ‰ã€ç«¶åˆæ™‚ã¯ãƒ­ãƒ¼ã‚«ãƒ«å„ªå…ˆã§è­¦å‘Šã€‚æ›´æ–°ç«¶åˆã¯ä¸–ä»£IDï¼‹æ›´æ–°æ™‚åˆ»ã§è§£æ±ºã—ã€ã‚»ãƒ«å†…é †åºï¼ˆpriorityï¼‰ã¯ã‚¿ã‚¹ã‚¯å˜ä½ã§ãƒãƒ¼ã‚¸ã—ã¤ã¤ã€åŒä¸€ã‚»ãƒ«å†…ã§åŒå€¤ï¼ˆé‡è¤‡ï¼‰ã‚„ã‚®ãƒ£ãƒƒãƒ—ä¸è¶³ãŒã‚ã‚‹å ´åˆã¯ PrioritySorter ã§æ­£è¦åŒ–ã™ã‚‹ã€‚BackupService ã‚’ä»‹ã—ã¦æ—¥æ¬¡/é€±æ¬¡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ã€å¾©å…ƒæ™‚ã¯åŒæœŸã‚’ä¸€æ™‚åœæ­¢ã—ãŸã†ãˆã§é©ç”¨â†’å†åŒæœŸã™ã‚‹ã€‚
- InProAutoTracker ã® 1 åˆ†åˆ»ã¿ã®é€²æ—ã¯ UI ãƒ­ãƒ¼ã‚«ãƒ«ã«ã¨ã©ã‚ã€ãƒãƒƒãƒåæ˜ æ™‚ã®ã¿ `syncState.dirty` ã‚’æ›´æ–°ã™ã‚‹ï¼ˆå³æ™‚ push ã‚’ç™ºç«ã•ã›ãªã„ï¼‰ã€‚åŒæœŸãƒˆãƒªã‚¬ãƒ¼ã¯æ‰‹å‹•/å®šæœŸ/ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ï¼ˆæ˜ç¤ºçš„ãªçŠ¶æ…‹å¤‰æ›´ï¼‰ã«é™å®šã—ã€ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã¨ãƒãƒƒãƒ†ãƒªãƒ¼ã‚’é¿ã‘ã‚‹ã€‚
- Invariant æ­£è¦åŒ–ï¼ˆãƒãƒ¼ã‚¸å¾Œï¼‰: ãƒªãƒ¢ãƒ¼ãƒˆå–ã‚Šè¾¼ã¿/ç«¶åˆè§£æ±ºã®çµæœã€`status=InPro` ãŒè¤‡æ•°å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€ãã‚Œã‚‰ã‚’ç™ºè¦‹é †ã« `OnHold` ã¸é †æ¬¡ `insertIndex=0` ã§æŒ¿å…¥ã—ï¼ˆæœ€å¾Œã«è¦‹ã¤ã‹ã£ãŸã‚‚ã®ãŒ OnHold æœ€ä¸Šä½ï¼‰ã€`AlertToast` ã§é€šçŸ¥ã™ã‚‹ã€‚viewMode=editable/readonly ã‚’å•ã‚ãšãƒ¢ãƒ¼ãƒ€ãƒ«ã¯è¡¨ç¤ºã›ãšã€å…¨ã¦ OnHold ã®ã¾ã¾ã¨ã™ã‚‹ã€‚
- Drive ã®ãƒãƒ¼ã‚¸/å·®åˆ†è¨ˆç®—ï¼ˆremoteâ†’localï¼‰ã¯ Web Worker ã«å§”è­²ã—ã€Worker ã¯ã€Œé©ç”¨å¯èƒ½ãª patchï¼ˆtasks/subjectsOrder/burndownHistory ãªã©ã®å·®åˆ†ï¼‰ã€ã‚’è¿”ã™ã€‚SyncEngine ã¯æˆ»ã‚Šå€¤ã‚’ TaskStore ã«é©ç”¨ã—ã€IndexedDB commit ã¨ `syncState` æ›´æ–°ã‚’è¡Œã†ã€‚
- ã‚¹ãƒ†ãƒ¼ãƒˆå–å¾—æ™‚ã« Drive ã‹ã‚‰å¤ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã¸å¾Œé€€ã—ãªã„ã‚ˆã†ã€DriveAdapter ã® head revision/etag ã‚’ç¢ºèªã—ã€ä¸–ä»£ID ãŒå¾Œé€€ã™ã‚‹å ´åˆã¯æ‹’å¦ã—ã¦å†å–å¾—ã™ã‚‹ï¼ˆæœ€æ–°ã®1ç‰ˆã®ã¿ã‚’åŒæœŸå¯¾è±¡ã¨ã—ã€æ—§ç‰ˆã¯ BackupService ç®¡ç†ä¸‹ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦æ‰±ã†ï¼‰ã€‚
- Risks: å¤§ããªå·®åˆ†ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹â†’ãƒãƒƒãƒåˆ†å‰²ã€‚
- viewMode=readonly ã®å ´åˆã€Drive/Calendar ã¸ã®æ›¸ãè¾¼ã¿ã‚’è¡Œã‚ãšã€è¨­å®šã•ã‚ŒãŸé–“éš”ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 1 åˆ†ï¼‰ã§ pull ã®ã¿å®Ÿè¡Œã—ã¦è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã€‚

#### DriveAdapter / CalendarAdapter
| Field | Detail |
|-------|--------|
| Intent | å„ API ã®å‘¼ã³å‡ºã—ã¨ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç† | 
| Requirements | 4.6-4.7,4.21-4.23,5.3,5.10 |
| Contracts | API |

**Implementation Notes**
- Drive: JSON ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å°‚ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ï¼ˆ`settings.json`, `sprint-{sprintId}.json`ï¼‰ã€`If-Match` ã‚’ç”¨ã„ãŸæ¥½è¦³ãƒ­ãƒƒã‚¯ã‚’å‰æã«ã™ã‚‹ã€‚`files.get` ã§ head revision/etag ã‚’å–å¾—ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚ˆã‚Šå¤ã„ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãªã„é˜²å¾¡ã‚’å…¥ã‚Œã‚‹ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ `/LPK/backups/` é…ä¸‹ã«åˆ†é›¢ã—ã€é€šå¸¸åŒæœŸãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯æ··åœ¨ã•ã›ãªã„ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ ¼ç´ã¯ zip å‰æï¼ˆ`common-{type}-{deviceId}-{isoDate}.zip` ã¨ `sprints-{type}-{YYYY-MM}-{deviceId}-{isoDate}.zip`ï¼‰ã§ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰/ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã®ãƒ•ãƒ«è»¢é€ã€‚éƒ¨åˆ†å–å¾—ã¯ä¸å¯ã®ãŸã‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ unzip ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
  - Sharing: é–²è¦§æ‹›å¾…/ç„¡åŠ¹åŒ–ã®ãŸã‚ã€å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ã® permissionsï¼ˆå…±æœ‰çŠ¶æ…‹ï¼‰ã‚’å–å¾—ã—ã€`permissionId` ã«ã‚ˆã‚‹ä»˜ä¸/å‰Šé™¤ã‚’è¡Œã†ã€‚ç„¡åŠ¹åŒ–æ™‚ã« `permissionId` ãŒä¸æ•´åˆãªå ´åˆã«å‚™ãˆã¦ã€permissions ã®å†å–å¾—ã¨çªåˆï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ UI ã®è¡¨ç¤ºã«å¿…è¦ï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã€‚
  - Drive åŒæœŸç”¨ JSON ã«ã¯ `schemaVersion` ã‚’å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦å«ã‚ã‚‹ï¼ˆä¾‹: `{ schemaVersion: 3, updatedAt: ISODateTime, data: {...} }`ï¼‰ã€‚ã‚¢ãƒ—ãƒªå†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚„æ›´æ–°ã§ä»•æ§˜å·®åˆ†ãŒã‚ã‚‹å ´åˆã§ã‚‚ã€èª­ã¿è¾¼ã¿æ™‚ã« `schemaVersion` ã‚’æ¤œè¨¼ã—ã¦æ®µéšçš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã€‚
  - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: `schemaVersion < currentSchemaVersion` ã®å ´åˆã€`vN â†’ vN+1` ã® migrator ã‚’é †ã«é©ç”¨ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ï¼ˆIndexedDBï¼‰ã¸ commit å¾Œã« Drive å´ã‚‚æœ€æ–° `schemaVersion` ã§ä¸Šæ›¸ãã™ã‚‹ï¼ˆæ›¸ãæˆ»ã—å‰ã« Drive ã® Revisionsï¼ˆã¾ãŸã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰ã§ 1 ä¸–ä»£ç¢ºä¿ï¼‰ã€‚
  - å¤±æ•—æ™‚ã®æ‰±ã„:
    - `schemaVersion` ãŒæœªçŸ¥ï¼ˆ`> currentSchemaVersion` ãªã©ï¼‰: å¾©å…ƒä¸èƒ½ã¨ã—ã¦åŒæœŸã‚’åœæ­¢ã—ã€ã€Œãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå­˜åœ¨ã—ãªã„ã€æ—¨ã¨å¾©å…ƒã§ããªã„æ—¨ã‚’æ˜è¨˜ã—ãŸãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ï¼ˆå¾©å…ƒã¯è©¦ã¿ãªã„ï¼‰ã€‚
    - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤±æ•—: éšœå®³ã¨ã—ã¦åŒæœŸã‚’åœæ­¢ã—ã€å¾©å…ƒã§ããªã„æ—¨ã‚’æ˜è¨˜ã—ãŸã†ãˆã§ã‚µãƒãƒ¼ãƒˆã«å•ã„åˆã‚ã›ã‚‹å°ç·šã‚’è¡¨ç¤ºã™ã‚‹ï¼ˆå¾©å…ƒã¯è©¦ã¿ãªã„ï¼‰ã€‚
- Calendar: syncToken ã§å·®åˆ†å–å¾—ã€ETag ã¨ updated ã‚’æ¯”è¼ƒã—ã¦ç«¶åˆã‚’æ¤œå‡ºã—ã€ç«¶åˆæ™‚ã¯ Google ã‚’å„ªå…ˆï¼ˆLPK å´ã®åŒä¸€ã‚¤ãƒ™ãƒ³ãƒˆå¤‰æ›´ã¯ç ´æ£„ã—ã¦ Google ã®å†…å®¹ã‚’æ¡ç”¨ï¼‰ã€‚åŒæœŸå¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ `summary`, `description`, `start`, `end`, `status`, `source` ã«é™å®šã—ã€ãã‚Œä»¥å¤–ã¯èª­ã¿å–ã‚Šå°‚ç”¨ã¾ãŸã¯éå¯¾è±¡ã€‚å‰Šé™¤ã¯ tombstone ã¨ã—ã¦ä¼æ’­ã—ã€LPK èµ·ç‚¹ã®å‰Šé™¤ã‚‚ Google èµ·ç‚¹ã®å‰Šé™¤ã‚‚åŒæ–¹ã¸åæ˜ ã™ã‚‹ã€‚recurrence ã¯åŒæœŸå¯¾è±¡å¤–ã§èª­ã¿å–ã‚Šã®ã¿ï¼ˆç¹°ã‚Šè¿”ã—äºˆå®šã¯è¡¨ç¤ºå°‚ç”¨ï¼‰ã€‚å¤±åŠ¹æ™‚ã¯ full syncã€‚
- Risks: ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆâ†’æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã¨ MSW ã§ãƒ†ã‚¹ãƒˆã€‚

#### StorageAdapter (IndexedDB)
| Field | Detail |
|-------|--------|
| Intent | ãƒ­ãƒ¼ã‚«ãƒ«æ°¸ç¶šï¼ˆçŠ¶æ…‹ï¼‹åŒæœŸçŠ¶æ…‹ï¼‰ |
| Requirements | 5.4,5.5 |
| Contracts | Service |

**Implementation Notes**
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã—ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§äº’æ›ç¶­æŒã€‚ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚¿ã‚¹ã‚¯ï¼‹è¨­å®šï¼‹ `syncState` ã‚’åŒä¸€ãƒãƒƒãƒã§ä¿å­˜ã™ã‚‹ã€‚
- IndexedDB ã®ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ Drive ã® `schemaVersion` ã¯åˆ¥ç®¡ç†ã¨ã™ã‚‹ã€‚èµ·å‹•æ™‚ã¯ã€Œ(1) IndexedDB ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ â†’ (2) Drive ã‹ã‚‰å–å¾—ã—ãŸ JSON ã® `schemaVersion` ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ â†’ (3) TaskStoreState ã¸é›†ç´„ã€ã®é †ã§æ•´åˆã‚’å–ã‚‹ã€‚

#### UpdateManager / ServiceWorker
| Field | Detail |
|-------|--------|
| Intent | ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œçŸ¥ã¨å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| Requirements | 4.1,5.8,5.9,5.14 |
| Contracts | Service |

**Implementation Notes**
- æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œçŸ¥: `version.json`ï¼ˆãƒ“ãƒ«ãƒ‰æ™‚ã«åŸ‹ã‚è¾¼ã‚“ã  appVersionï¼‰ã‚’ fetch ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã¨æ¯”è¼ƒã—ã€æ–°ç‰ˆãªã‚‰ Service Worker `registration.update()` ã‚’å®Ÿè¡Œã€‚`updatefound/statechange` ã§å®Œäº†ã‚’ç›£è¦–ã—ã€å¼·åˆ¶æ›´æ–°æ™‚ã¯ `skipWaiting` â†’ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã« `postMessage` ã§ãƒªãƒ­ãƒ¼ãƒ‰è¦æ±‚ã€‚æœªåŒæœŸå¤‰æ›´ãŒã‚ã‚‹å ´åˆã¯åŒæœŸå®Œäº†ã¾ã§ãƒªãƒ­ãƒ¼ãƒ‰é…å»¶ã€‚
- `version.json` ã¯æ›´æ–°æ¤œçŸ¥ã®å˜ä¸€ä¿¡é ¼ã‚½ãƒ¼ã‚¹ã§ã‚ã‚‹ãŸã‚ã€Service Worker ã® precache/HTTP ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«å–ã‚Šè¾¼ã¾ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ï¼ˆ`@vite-pwa/plugin`/Workbox ã®è¨­å®šã§ precache å¯¾è±¡ã‹ã‚‰é™¤å¤–ã—ã€`/version.json` ã¯ NetworkOnly ã§å–å¾—ã™ã‚‹ï¼‰ã€‚
- å¼·åˆ¶æ›´æ–°æ™‚ã®å„ªå…ˆé †ä½: `syncState.dirty` ãŒ true ã®å ´åˆã¯ `skipWaiting` ã‚’é…å»¶ã—ã€å³åº§ã« `SyncEngine.sync()` ã‚’è©¦è¡Œã™ã‚‹ã€‚æˆåŠŸå¾Œã« `skipWaiting`ã€‚å¤±æ•—/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯æ›´æ–°ã‚’ä¿ç•™ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«ã€Œãƒ­ãƒ¼ã‚«ãƒ«ã« temp ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ä½œã£ã¦å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰ã€ã‚’é¸ã‚“ã å ´åˆã®ã¿åŒæœŸå‰ãƒªãƒ­ãƒ¼ãƒ‰ã‚’è¨±å¯ã™ã‚‹ã€‚
- æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: SettingsPanel ã‹ã‚‰ã®ã€Œæ›´æ–°ã‚’ç¢ºèªã€ãŒ UpdateManager.checkForUpdate ã‚’å‘¼ã³å‡ºã—ã€ä¸Šè¨˜ã¨åŒã˜æ¤œçŸ¥â†’æ›´æ–°ãƒ•ãƒ­ãƒ¼ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ã€‚è‡ªå‹•ãƒã‚§ãƒƒã‚¯ã¨ã®è¡çªã‚’é¿ã‘ã‚‹ãŸã‚ã€å®Ÿè¡Œä¸­ã¯é‡è¤‡ãƒã‚§ãƒƒã‚¯ã‚’æŠ‘æ­¢ã™ã‚‹ã€‚

### Infra/Tooling
- Auth: Google OAuthï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã¯ãƒ¡ãƒ¢ãƒªã¾ãŸã¯ Session Storageã€é•·æœŸä¿å­˜ã—ãªã„ï¼‰ã€‚é–²è¦§å°‚ç”¨ã¯ã€Œå­¦ç¿’è€…ãŒé–²è¦§è€…ã® Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æ‹›å¾…ã—ã€æ‹›å¾… URLï¼ˆ`sharedFolderId` + `mode=readonly`ï¼‰ã‚’å…±æœ‰ã™ã‚‹ã€ã“ã¨ã§æä¾›ã™ã‚‹ã€‚AppShell/Router ãŒå¯¾è±¡ `dataFolderId` ã®èª­ã¿å–ã‚Šå¯å¦ï¼ˆcanEdit ãªã©ï¼‰ã¨ `mode=readonly` ã«åŸºã¥ã viewMode ã‚’åˆ¤å®šã™ã‚‹ã€‚Drive API ã® 401/403/404 ã¯ã€Œèªè¨¼åˆ‡ã‚Œ/æ¨©é™ä¸è¶³/æ‹›å¾…ç„¡åŠ¹/ä¸€æ™‚éšœå®³ã€ã‚’åŒºåˆ¥ã—ã¦æ‰±ã„ã€å†è©¦è¡Œãƒ»å†èªè¨¼ãƒ»ãƒªãƒ³ã‚¯å†å…¥åŠ›ã¸èª˜å°ã™ã‚‹ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ã¯è‡ªå‹•ã§ã¯è¡Œã‚ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºæ“ä½œã§ã®ã¿å®Ÿè¡Œã™ã‚‹ã€‚
- CI: testâ†’buildâ†’deploy to Pages ã‚’è‡ªå‹•åŒ–ã€‚
- RepoSetupScript: gh API ã‚’ç”¨ã„ã¦ main ä¿è­·ï¼ˆå¿…é ˆãƒã‚§ãƒƒã‚¯/ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ã€ãƒãƒ¼ã‚¸æ–¹å¼ï¼ˆSquash/é€šå¸¸ãƒãƒ¼ã‚¸è¨±å¯, Rebase ç„¡åŠ¹ï¼‰ã€ãƒ–ãƒ©ãƒ³ãƒè‡ªå‹•å‰Šé™¤ã€å¿…è¦ã«å¿œã˜ã¦ Pages è¨­å®šã‚’é©ç”¨ã™ã‚‹ã€‚å…¥åŠ›: ãƒªãƒã‚¸ãƒˆãƒª owner/repo; å‡ºåŠ›: è¨­å®šçµæœï¼ˆãƒ­ã‚°ï¼‰ã€‚

## Data Models

### Domain Model
- **Task**: id, title, detail, subjectId, status, priorityï¼ˆã‚®ãƒ£ãƒƒãƒ—ä»˜ã rankã€‚æ•°å€¤ãŒå¤§ãã„ã»ã©ä¸Šï¼é«˜å„ªå…ˆåº¦ï¼‰, estimateMinutes, actuals: TaskActual[], dueAt, createdAt, updatedAt.
- **Subject**: id, name.
- **Sprint**: id (ã‚¹ãƒ—ãƒªãƒ³ãƒˆé–‹å§‹ã® ISODateTime ã‚’æ¨å¥¨), startAt (Mon 00:00:00), endAt, subjectsOrder (SubjectId[]), dayOverrides[{at, availableMinutes}]ï¼ˆã‚¹ãƒ—ãƒªãƒ³ãƒˆå†…ã®ç‰¹å®šæ—¥ä¸Šæ›¸ãã€‚00:00:00 ã‚’ä½¿ç”¨ï¼‰, burndownHistory: BurndownHistoryEntry[]
- **CalendarEvent**: id, title, description, start/end, status, source (LPK/Google), etag.
  - ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å…¨ä½“ã® `syncToken` ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ¡ã‚¿ã¨ã—ã¦ç®¡ç†ã—ã€ã‚¤ãƒ™ãƒ³ãƒˆã”ã¨ã«ã¯æŒãŸã›ãªã„ã€‚
- **Settings**: statusLabels, dayDefaultAvailability.
- **SharingSettingsï¼ˆSettings å†…ï¼‰**: viewerPermissionIdsï¼ˆé–²è¦§æ‹›å¾…ã§ä»˜ä¸ã—ãŸ Drive ã® `permissionId` ä¸€è¦§ï¼‰
- **UiSettingsï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å°‚ç”¨ï¼‰**: deviceId ï¼ˆåˆå›èµ·å‹•æ™‚ã« `crypto.randomUUID()` ã§ç”Ÿæˆã—ãŸç«¯æœ«ãƒ­ãƒ¼ã‚«ãƒ«è­˜åˆ¥å­ï¼‰, readonlyRefreshIntervalSecï¼ˆé–²è¦§å°‚ç”¨æ™‚ã®å®šæœŸ pull é–“éš”ãƒ»ç§’ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 60), currentSprintIdï¼ˆç¾åœ¨è¡¨ç¤ºä¸­ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/åŒæœŸå¯¾è±¡å¤–ï¼‰ã€‚
- **SyncState**: dirtyï¼ˆæœªåŒæœŸå¤‰æ›´ã®æœ‰ç„¡ï¼‰, lastSyncedAt, localGenerationï¼ˆãƒ­ãƒ¼ã‚«ãƒ« commit ã®å˜èª¿å¢—åŠ ã‚«ã‚¦ãƒ³ã‚¿ï¼‰, driveHeadsï¼ˆ`settings.json` ã¨å„ `sprint-{sprintId}.json` ã® `{ etag, updatedAt }`ï¼‰, calendarSyncTokenï¼ˆå·®åˆ†å–å¾—ç”¨ã€å¿…è¦ãªã‚‰ï¼‰ã€‚
- **BackupSnapshot**: id, createdAt, deviceId, manifestVersion, files[{name, path, checksum, kind (common|sprints), month (YYYY-MM)?}], retentionSlot (daily/weekly), type (daily/weekly/temp/manual), isoDate, source (local/remote).
- **BurndownHistoryEntry**: at, remainingMinutes, remainingCountï¼ˆéå»æ—¥ä»˜ã®ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³è¡¨ç¤ºç”¨ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã€‚00:00:00 ã‚’ä½¿ç”¨ï¼‰

### Logical Data Model
- IndexedDB ã‚¹ãƒˆã‚¢: `tasks`, `subjects`, `sprints`, `settings`, `syncState`, `calendarEvents`ã€‚ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ã“ã‚Œã‚‰ã‚’é›†ç´„ã—ã¦ TaskStoreState ã«è¼‰ã›ã‚‹ï¼ˆTaskStoreState ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã¯1å¯¾1ã§ã¯ãªã„ï¼‰ã€‚
- IndexedDB ã‚¹ãƒˆã‚¢ï¼ˆãƒ­ãƒ¼ã‚«ãƒ« UIï¼‰: `uiSettings`ã€‚`deviceId` ã¨é–²è¦§è€…ã®è‡ªå‹•æ›´æ–°é–“éš”ãªã©ã€Drive ã¨åŒæœŸã—ãªã„è¨­å®šã‚’ä¿æŒã™ã‚‹ã€‚
- Key: `Task.id` ã¯ uuidã€‚`Task` ã® status ã¯å›ºå®š enumã€‚
- Consistency: Task/Subject/Sprint/Settings ã¨ `syncState` ã¯åŒä¸€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§æ›´æ–°ã™ã‚‹ã€‚æ•™ç§‘å‰Šé™¤æ™‚ã¯ã‚¿ã‚¹ã‚¯å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã§ç¦æ­¢ã€‚ã‚»ãƒ«å†…é †åºã¯ Task.priority ã§ä¿æŒã™ã‚‹ï¼ˆä¸ŠãŒé«˜å„ªå…ˆåº¦ã€ä¸‹ãŒä½å„ªå…ˆåº¦ï¼‰ã€‚
- BurndownHistory: éå»æ—¥ä»˜ã®æ®‹å·¥æ•°ï¼ˆä»¶/è¦‹ç©æ™‚é–“ï¼‰ã¯ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã® `burndownHistory` ã«æ—¥æ¬¡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦ä¿æŒã—ã€éå»è¡¨ç¤ºã¯ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’å„ªå…ˆã™ã‚‹ï¼ˆæ¬ ææ™‚ã®ã¿å†è¨ˆç®—ï¼‰ã€‚
- updatedAt é‹ç”¨: ãƒ­ãƒ¼ã‚«ãƒ«ç·¨é›†æ™‚ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ã® updatedAt ã‚’ç¾åœ¨æ™‚åˆ»ã§æ›´æ–°ã€‚ä¸¦ã³æ›¿ãˆï¼ˆå„ªå…ˆåº¦å¤‰æ›´ï¼‰ã§è¤‡æ•° Task ã® priority ãŒå¤‰ã‚ã£ãŸå ´åˆã¯ã€åŒä¸€æ“ä½œã§æ›´æ–°ã•ã‚ŒãŸ Task ã® updatedAt ã‚’æƒãˆã‚‹ã€‚applyRemote ã§æ¡ç”¨ã—ãŸãƒªãƒ¢ãƒ¼ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ãƒªãƒ¢ãƒ¼ãƒˆã® updatedAt ã‚’ä¿æŒã€‚ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãå‡ºã—æ™‚ã«ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã® updatedAt ã‚‚æ›´æ–°ã™ã‚‹ã€‚
- ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã‚¿ã‚¤ãƒŸãƒ³ã‚°: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§æœªæ¥é€±ã‚’å‚ç…§ã—ãŸã ã‘ã§ã¯ä½œæˆã—ãªã„ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆviewMode=editableï¼‰ ãŒæ˜ç¤ºçš„ã«ã€Œã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’è¡¨ç¤ºã€ã‚’ç¢ºå®šã—ãŸæ™‚ç‚¹ã§ `sprint-{sprintId}.json` ã‚’æ–°è¦ä½œæˆï¼ˆå­˜åœ¨ã—ãªã„å ´åˆï¼‰ã€‚éå»ã‚¹ãƒ—ãƒªãƒ³ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã›ãšä¿æŒã™ã‚‹ã€‚ç¾åœ¨è¡¨ç¤ºä¸­ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆã¯ `UiSettings.currentSprintId` ã«ä¿æŒã™ã‚‹ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/åŒæœŸå¯¾è±¡å¤–ï¼‰ã€‚viewMode=readonly ã§ã¯ã‚¹ãƒ—ãƒªãƒ³ãƒˆã®åˆ‡æ›¿ã¯å¯èƒ½ã ãŒã€æœªä½œæˆã®é€±ã‚’é¸ã‚“ã§ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã¯è¡Œã‚ãªã„ã€‚
- ã‚¹ãƒ—ãƒªãƒ³ãƒˆæœªé–‹å§‹é€±ã®ç·¨é›†: viewMode=editable ã§ã¯ã€ã‚¹ãƒ—ãƒªãƒ³ãƒˆãŒæœªé–‹å§‹ã®é€±ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼/Availability ã‚’é–²è¦§ã®ã¿ã«åˆ¶é™ã—ã€å­¦ç¿’å¯èƒ½æ™‚é–“ã®ä¸Šæ›¸ãã‚„ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç·¨é›†ã¯ã€Œã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚’è¡¨ç¤ºã€ç¢ºå®šå¾Œã«ã®ã¿è¨±å¯ã™ã‚‹ã€‚viewMode=readonly ã¯å¸¸ã«é–²è¦§ã®ã¿ã¨ã™ã‚‹ã€‚
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿å­˜å…ˆï¼ˆDrive å´ï¼‰: `/LPK/backups/` é…ä¸‹ã« `common-{type}-{deviceId}-{isoDate}.zip`ï¼ˆsettings/calendarEvents/manifestï¼‰ã¨ `sprints-{type}-{YYYY-MM}-{deviceId}-{isoDate}.zip`ï¼ˆé–‹å§‹æœˆã”ã¨ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆç¾¤ï¼‰ã‚’ä¿å­˜ã™ã‚‹ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ IndexedDB ã«ã¯æ ¼ç´ã—ãªã„ï¼ˆå¿…è¦æ™‚ã« Drive ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å¾©å…ƒï¼‰ã€‚

### Data Contracts & Integration
- **Drive**: `/LPK/` é…ä¸‹ã«ã‚¹ãƒ—ãƒªãƒ³ãƒˆå˜ä½ã® `sprint-{sprintId}.json`ï¼ˆtasks, subjectsOrder, dayOverrides, burndownHistoryï¼‰ã¨ `settings.json`ï¼ˆstatusLabels, dayDefaultAvailability, viewerPermissionIds ç­‰ï¼‰ã‚’ä¿å­˜ã™ã‚‹ã€‚å„ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `schemaVersion` ã¨ `updatedAt` ã‚’æŒã¤ã‚¨ãƒ³ãƒ™ãƒ­ãƒ¼ãƒ—å½¢å¼ï¼ˆ`{ schemaVersion, updatedAt, data }`ï¼‰ã¨ã—ã€èª­ã¿è¾¼ã¿æ™‚ã« `schemaVersion` ã‚’æ¤œè¨¼ã—ã¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã€‚æ›´æ–°ã¯ `If-Match` ï¼ˆetagï¼‰ã§æ¥½è¦³ãƒ­ãƒƒã‚¯ã—ã€ç«¶åˆæ™‚ã¯ pullâ†’mergeâ†’push ã§è§£æ±ºã™ã‚‹ã€‚settings.json ã®ç«¶åˆè§£æ±ºã¯ `updatedAt` ã‚’åŸºæº–ã«ã—ã¤ã¤ã€ãƒªãƒ¢ãƒ¼ãƒˆå€¤ã§ä¸Šæ›¸ãã™ã‚‹ã‹ã©ã†ã‹ã‚’é …ç›®å˜ä½ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ç¢ºèªã™ã‚‹ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§ã€Œã“ã®é …ç›®ã‚’ãƒªãƒ¢ãƒ¼ãƒˆå€¤ã§ä¸Šæ›¸ãã™ã‚‹ã€ã‚’é¸æŠã—ã€æœªé¸æŠã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚’ç¶­æŒï¼‰ã€‚ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¿ã‚¹ã‚¯å˜ä½ã§ `updatedAt` ã¨ priority ã‚’ãƒãƒ¼ã‚¸ã—ã€åŒä¸€ã‚»ãƒ«å†…ã§åŒå€¤ï¼ˆé‡è¤‡ï¼‰ã‚„ã‚®ãƒ£ãƒƒãƒ—ä¸è¶³ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ PrioritySorter ã§æ­£è¦åŒ–ã™ã‚‹ã€‚å®Ÿç¸¾ï¼ˆ`Task.actuals`ï¼‰ã¯ `TaskActual.id` ã‚’ã‚­ãƒ¼ã¨ã—ã¦ **union ãƒãƒ¼ã‚¸**ã—ã€ç‰‡å´ã«ã—ã‹å­˜åœ¨ã—ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯è¿½åŠ ã™ã‚‹ã€‚ä¸¡å´ã«åŒä¸€ `id` ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ `updatedAt` ã‚’æ¯”è¼ƒã—ã¦æ–°ã—ã„æ–¹ã‚’æ¡ç”¨ã—ã€åŒå€¤ã®å ´åˆã¯ `updatedByDeviceId` ã®è¾æ›¸é †ã§ tie-break ã™ã‚‹ã€‚å‰Šé™¤ã¯ `deletedAt` tombstone ã‚’åŒæœŸã§ä¼æ’­ã—ã€`deletedAt` ãŒå­˜åœ¨ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ UI é›†è¨ˆã‹ã‚‰é™¤å¤–ã™ã‚‹ã€‚`SyncState` ã¯ãƒ­ãƒ¼ã‚«ãƒ«å°‚ç”¨ã§ Drive ã«ã¯ä¿å­˜ã—ãªã„ã€‚
- **Calendar**: äºˆå®šã¯ Google Calendar ã‹ã‚‰å¸¸ã«å–å¾—ã—ã€IndexedDB ã® `calendarEvents` ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦è¡¨ç¤ºã™ã‚‹ã€‚Google Drive ã®é€šå¸¸åŒæœŸãƒ‡ãƒ¼ã‚¿ã«ã¯ä¿å­˜ã—ãªã„ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«å«ã‚ã‚‹å ´åˆã®ã¿ `calendarEvents.json` ã¨ã—ã¦ä¿å­˜ï¼‰ã€‚å­¦ç¿’å¯èƒ½æ™‚é–“ã®ç®—å‡ºã«ã¯è‡ªå‹•åæ˜ ã›ãšã€è¡¨ç¤ºã®ã¿ã¨ã™ã‚‹ã€‚LPK èµ·ç‚¹ã‚¤ãƒ™ãƒ³ãƒˆã¯ source=LPK ã‚’ä»˜ä¸ã—äºŒé‡åæ˜ ã‚’é˜²æ­¢ã—ã€ç«¶åˆæ™‚ã¯ Google ã‚’å„ªå…ˆã™ã‚‹ã€‚
- **Internal Events**: `SyncStatusChanged`, `UpdateAvailable`, `PomodoroTick`, `InProConflictDetected` ã‚’ç™ºè¡Œã— UI é€šçŸ¥ã¨å†è¨ˆç®—ã‚’ãƒˆãƒªã‚¬ã€‚

## Error Handling

### Error Strategy
- æ—©æœŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã€ãƒãƒªã‚·ãƒ¼åˆ¤å®šï¼‰ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ©ãƒ¼ã‚’å³æ™‚è¿”å´ã€‚
- åŒæœŸ/API å¤±æ•—ã¯éãƒ¢ãƒ¼ãƒ€ãƒ«ã§é€šçŸ¥ã—ã€å†è©¦è¡Œãƒœã‚¿ãƒ³ã‚’æä¾›ã€‚ãƒªãƒˆãƒ©ã‚¤ã¯æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã€‚
- PWA æ›´æ–°ã¯é€šçŸ¥å¾Œã«è‡ªå‹•ãƒªãƒ­ãƒ¼ãƒ‰ã€‚ä¿å­˜ã•ã‚Œã¦ã„ãªã„å¤‰æ›´ãŒã‚ã‚‹å ´åˆã¯åŒæœŸå®Œäº†ã¾ã§é…å»¶ã€‚

### Error Categories and Responses
- User Errors: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æœªå…¥åŠ›/å½¢å¼ä¸æ­£ â†’ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼è¡¨ç¤º; ãƒãƒªã‚·ãƒ¼é•åï¼ˆTodayâ†’InPro ãªã©ï¼‰â†’ Toast ã§ç†ç”±è¡¨ç¤ºã€‚
- System Errors: Drive/Calendar API å¤±æ•— â†’ å†è©¦è¡Œå¯èƒ½é€šçŸ¥; IndexedDB å¤±æ•— â†’ å†èª­ã¿è¾¼ã¿ã‚’ä¿ƒã—ã€ãƒ‡ãƒ¼ã‚¿ä¿è­·ã®ãŸã‚åŒæœŸã‚’åœæ­¢ã€‚
- Business Logic Errors: Done é·ç§»ç¦æ­¢æ¡ä»¶ã€InPro è¤‡æ•°ç¦æ­¢ â†’ ãƒãƒªã‚·ãƒ¼æ‹’å¦ã‚’è¿”ã— UI ã§æç¤ºã€‚
- Data Compatibility Errors: `schemaVersion` ãŒæœªçŸ¥ã€ã¾ãŸã¯ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•— â†’ åŒæœŸã‚’åœæ­¢ã—ã€å¾©å…ƒã§ããªã„æ—¨ã‚’æ˜è¨˜ã—ãŸãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºï¼ˆæœªçŸ¥ã®å ´åˆã¯ã€Œãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå­˜åœ¨ã—ãªã„ã€ã€å¤±æ•—ã®å ´åˆã¯ã‚µãƒãƒ¼ãƒˆå•ã„åˆã‚ã›å°ç·šï¼‰ã€‚

### Monitoring
- Service Worker/åŒæœŸã‚¨ãƒ©ãƒ¼ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¨ UI ã« surfacedã€‚å°†æ¥ã®é éš”ãƒ­ã‚®ãƒ³ã‚°ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ®‹ã™ãŒå®Ÿè£…ã¯å¾Œç¶šã€‚

## Testing Strategy
- Unit: StatusPolicyï¼ˆé·ç§»ã‚¬ãƒ¼ãƒ‰ã€å‰¯ä½œç”¨ï¼‰ã€TimeCalcï¼ˆæ®‹ã‚Šæ™‚é–“/è² è·/æœŸæ—¥ï¼‰ã€Availabilityï¼ˆäºˆå®šæ§é™¤ã¨ä¸Šæ›¸ãï¼‰ã€Burndown è¨ˆç®—ã€SyncEngine ã®ãƒãƒ¼ã‚¸/ç«¶åˆå‡¦ç†ã€‚
- Integration: KanbanBoard+Dnd ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰/ãƒã‚¦ã‚¹ã€TaskDialog ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒˆãƒ©ãƒƒãƒ—ã€SyncEngine ã¨ StorageAdapter ã®æ°¸ç¶šã€CalendarAdapter ã® syncToken ãƒªã‚«ãƒãƒªã€‚
- E2E (Playwright): ã‚¿ã‚¹ã‚¯ä½œæˆâ†’InPro ã¸ã®ç§»å‹•ã‚¬ãƒ¼ãƒ‰ã€Today éè² è·è­¦å‘Šã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ“ä½œâ†’å†æ¥ç¶šåŒæœŸã€é–²è¦§å°‚ç”¨ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤ºã€‚
- Performance: æ•™ç§‘ 14ï¼ˆå­¦æ ¡ 9 + å¡¾ 5ï¼‰ã€å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ 6 åˆ—ã®å„ã‚»ãƒ«ã« 35 æšï¼ˆæœ€å¤§ç´„ 2,940 æšï¼‰ã‚’é…ç½®ã—ãŸçŠ¶æ…‹ã§ã® DnD/ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¿œç­”ã€åŒæœŸæ™‚ã®ãƒãƒƒãƒå‡¦ç†æ™‚é–“ã€‚

## Security Considerations
- Google OAuth ãƒˆãƒ¼ã‚¯ãƒ³ã¯é•·æœŸä¿å­˜ã—ãªã„ï¼ˆãƒ¡ãƒ¢ãƒª/Session Storageï¼‰ã€‚Drive/Calendar scope ã‚’æœ€å°é™ã«é™å®šã€‚
- é–²è¦§å°‚ç”¨ã¯ Google Drive ã®å…±æœ‰æ¨©é™ã§æä¾›ã™ã‚‹ã€‚å…±æœ‰è§£é™¤ã‚„æ¨©é™å¤‰æ›´ã§ Drive API ãŒ 403/404 ã‚’è¿”ã™å ´åˆãŒã‚ã‚‹ãŒã€ãƒˆãƒ¼ã‚¯ãƒ³å¤±åŠ¹ã‚„ä¸€æ™‚éšœå®³ç­‰ã§ã‚‚èµ·ã“ã‚Šã†ã‚‹ãŸã‚ã€å¤±åŠ¹æ‰±ã„ã§ã®è‡ªå‹•å‰Šé™¤ã¯ã—ãªã„ã€‚å¤±æ•—æ™‚ã¯å†è©¦è¡Œãƒ»å†èªè¨¼ãƒ»ãƒªãƒ³ã‚¯å†å…¥åŠ›ã®å°ç·šã‚’æç¤ºã—ã€ã€Œãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»ã™ã‚‹ã€ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ„å›³ã—ã¦é¸æŠã—ãŸå ´åˆã®ã¿å®Ÿè¡Œã™ã‚‹ã€‚
- Service Worker ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã¯æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ãšã€IndexedDB ã‚‚åŒæ§˜ã«å€‹äººæƒ…å ±ã‚’æœ€å°åŒ–ã€‚

## Performance & Scalability
- Board æç”»ã¯ãƒãƒ¼ãƒãƒ£ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‰æã«æ‹¡å¼µå¯èƒ½ãªæ§‹é€ ã§å®Ÿè£…ã™ã‚‹ã€‚ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®æ”¯é…çš„ã‚³ã‚¹ãƒˆã‚’ä¸‹ã’ã‚‹ãŸã‚ã€æ•™ç§‘è¡Œå˜ä½ã®ãƒãƒ¼ãƒãƒ£ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å„ªå…ˆã—ã€å¿…è¦ã«å¿œã˜ã¦è¡Œå†…ã®åˆ—ãƒªã‚¹ãƒˆã‚’éƒ¨åˆ†çš„ã«ä»®æƒ³åŒ–ã™ã‚‹ã€‚TimeCalc/Burndown ã¯ãƒ¡ãƒ¢åŒ–ã€‚
- åŒæœŸã¯ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã® pullâ†’mergeâ†’push ã¨ã—ã€`syncState.dirty` ã®å ´åˆã®ã¿ push ã™ã‚‹ã€‚Calendar ã¯å·®åˆ†å–å¾—ã§é€šä¿¡é‡ã‚’æŠ‘åˆ¶ã€‚
- å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã®å†ãƒ­ãƒ¼ãƒ‰å‰ã«åŒæœŸã‚’å®Œäº†ã•ã›ã€ãƒ‡ãƒ¼ã‚¿æå¤±ã‚’é˜²æ­¢ã€‚
- æ€§èƒ½ãƒ™ãƒ³ãƒå¯¾è±¡ã¯è¦ä»¶ 1.12 ã®ã€Œæ•™ç§‘ 14 Ã— å›ºå®šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ 6 åˆ— Ã— å„ã‚»ãƒ« 35 æšï¼ˆç´„ 2,940 ã‚«ãƒ¼ãƒ‰ï¼‰ã€ã‚’åŸºæº–ã¨ã—ã€PoC/ãƒ†ã‚¹ãƒˆã‚‚åŒæ¡ä»¶ã§è©•ä¾¡ã™ã‚‹ã€‚

## Supporting References
- è©³ç´°ãª API å‘¼ã³å‡ºã—ä»•æ§˜ã‚„ç«¶åˆè§£æ±ºãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ `research.md` ã® Design Decisions ã¨ Research Log ã‚’å‚ç…§ã€‚
- é–²è¦§å°‚ç”¨ãƒ¢ãƒ¼ãƒ‰ã§ç®¡ç†: `viewMode`ï¼ˆeditable|readonlyï¼‰ã‚’ Router/AppShell ã‹ã‚‰å—ã‘å–ã‚Šã€ç·¨é›†ç³»æ“ä½œï¼ˆDnD/ãƒ€ã‚¤ã‚¢ãƒ­ã‚°èµ·å‹•/ä¿å­˜ï¼‰ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚
- viewMode ãŒ readonly ã®å ´åˆã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¿ã‚¹ã‚¯/ã‚¹ãƒ—ãƒªãƒ³ãƒˆ/è¨­å®š/äºˆå®šï¼‰ã¸ã®æ›¸ãè¾¼ã¿ã«é–¢ã‚ã‚‹å…¥åŠ›ã‚’ç„¡åŠ¹åŒ–ã—è¡¨ç¤ºå°‚ç”¨ã¨ã™ã‚‹ï¼ˆä¾‹å¤–: `UiSettings` ã®å¤‰æ›´ã€ã‚¹ãƒ—ãƒªãƒ³ãƒˆã®é¸æŠã€æ›´æ–°é–“éš”è¨­å®šãªã©ã®ç«¯æœ«ãƒ­ãƒ¼ã‚«ãƒ« UI è¨­å®šã¯è¨±å¯ï¼‰ã€‚
